<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบวางแผนการเรียน 4 ปี (Interactive Study Plan)</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Libraries for Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c7c7c7; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }
        
        .card-drag {
            cursor: grab;
            transition: all 0.2s ease;
        }
        .card-drag:active {
            cursor: grabbing;
            transform: scale(0.95);
        }
        .droppable-area {
            transition: background-color 0.2s;
        }
        .droppable-area.drag-over {
            background-color: #e0e7ff; /* indigo-100 */
            border: 2px dashed #4f46e5;
        }
        .card-drag.drag-over-item {
            border-top: 3px solid #4f46e5;
            margin-top: 4px;
        }
        
        /* Modal Animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .modal-overlay {
            animation: fadeIn 0.2s ease-out;
        }
        .modal-content {
            animation: slideUp 0.3s ease-out;
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useRef } = React;

        // --- Configuration ---
        const CATEGORIES = {
            'GenEd': { label: '1. หมวดวิชาศึกษาทั่วไป', color: 'bg-green-100 text-green-800', border: 'border-green-200', shortLabel: 'ศึกษาทั่วไป' },
            'CoreFund': { label: '2.1 กลุ่มวิชาพื้นฐานวิชาชีพ', color: 'bg-blue-100 text-blue-800', border: 'border-blue-200', shortLabel: 'พื้นฐานวิชาชีพ' },
            'CoreComp': { label: '2.2 กลุ่มวิชาบังคับ', color: 'bg-indigo-100 text-indigo-800', border: 'border-indigo-200', shortLabel: 'วิชาบังคับ' },
            'CoreElec': { label: '2.3 กลุ่มวิชาเลือก (เฉพาะ)', color: 'bg-sky-100 text-sky-800', border: 'border-sky-200', shortLabel: 'วิชาเลือกเฉพาะ' },
            'CoreExp': { label: '2.4 กลุ่มวิชาการฝึกประสบการณ์ฯ', color: 'bg-purple-100 text-purple-800', border: 'border-purple-200', shortLabel: 'ฝึกประสบการณ์ฯ' },
            'FreeElec': { label: '3. หมวดวิชาเลือกเสรี', color: 'bg-orange-100 text-orange-800', border: 'border-orange-200', shortLabel: 'เลือกเสรี' }
        };

        // --- Helper: Download Text File ---
        const downloadTextFile = (filename, content) => {
            const element = document.createElement('a');
            const file = new Blob([content], {type: 'text/plain'});
            element.href = URL.createObjectURL(file);
            element.download = filename;
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        };

        // --- Mock Data ---
        const INITIAL_COURSES = [
            // หมวดศึกษาทั่วไป (GenEd)
            { id: 'gen001', code: '00-400-060-006', name: 'กุญแจสู่ความสำเร็จ (Keys to Success)', credits: 1, category: 'GenEd', description: 'ทฤษฎีความสำเร็จในด้านการทำงาน การทำธุรกิจและการดำเนินชีวิต การประยุกต์ใช้การแก้ปัญหาจากแนวปฏิบัติที่ดี เครื่องมือ กลยุทธ์และกุญแจสู่ความสำเร็จทางธุรกิจ การวัดความสำเร็จของการประกอบธุรกิจและเรียนรู้ปรากฎการณ์ความล้มเหลว การวิเคราะห์สาเหตุหรือปัญหา วิธีป้องกันในกรณีศึกษาต่าง ๆ การใช้ชีวิตหรือการประกอบการธุรกิจ\nTheories of success in work, business, and daily life; applying problem-solving from best practices; tools, strategies, and keys to business success.', clos: ['อธิบายทฤษฎีความสำเร็จในด้านการทำงาน การทำธุรกิจ และการดำเนินชีวิต', 'วิเคราะห์สาเหตุและปัญหาของความล้มเหลวจากกรณีศึกษา เพื่อสรุปความคิดรวมยอดและนำเสนอได้'] },
            { id: 'gen002', code: '00-400-070-008', name: 'ภาษาไทยในยุคดิจิทัล (Thai in the Digital Age)', credits: 3, category: 'GenEd', description: 'การใช้ภาษาไทยในสื่อโซเซียล การรู้เท่าทันสื่อ จรรยาบรรณการใช้ภาษาไทยในสื่อดิจิทัล ความคิดสร้างสรรค์ในการใช้ภาษา การสร้างแนวทางเพื่อการต่อยอดการใช้ภาษาในการสื่อสารผ่านสื่อดิจิทัลสำหรับอนาคต', clos: ['ใช้ภาษาไทยในสื่อโซเชียลมีเดียอย่างเหมาะสม', 'เลือกสื่อในการสื่อสารผ่านสื่อดิจิทัลอย่างเหมาะสม', 'มีความคิดสร้างสรรค์ในการใช้ภาษาเพื่อสื่อสารผ่านสื่อดิจิทัล และต่อยอดการใช้ภาษาในสื่อดิจิทัลในอนาคต', 'ทำงานร่วมกับผู้อื่น มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'gen003', code: '00-400-070-004', name: 'ภาษาอังกฤษพื้นฐาน (Basic English)', credits: 3, category: 'GenEd', description: 'คำศัพท์ สำนวนและประโยคภาษาอังกฤษพื้นฐานเพื่อการสื่อสารในระดับเริ่มต้น ในสถานการณ์ต่างๆ การทักทาย การแนะนำ การถามและตอบคำถามเกี่ยวกับข้อมูลส่วนบุคคล สถานที่อยู่อาศัย คนที่รู้จักและสิ่งของ การฝึกปฏิบัติการใช้ทักษะภาษาอังกฤษในการฟัง พูด อ่าน และเขียน เพื่อการสื่อสารในระดับเริ่มต้น การใช้ภาษาอังกฤษพื้นฐานในการมีปฏิสัมพันธ์กับผู้อื่นด้วยวิธีการและภาษาที่ง่าย ถูกต้อง เหมาะสมและไม่ซับซ้อน', clos: ['ใช้คำศัพท์ สำนวน วลีและประโยคภาษาอังกฤษพื้นฐาน เพื่อการสื่อสารในระดับเริ่มต้นตามสถานการณ์ต่างๆ ในชีวิตประจำวัน', 'ใช้ภาษาอังกฤษในการฟัง พูด อ่าน และเขียน ด้วยคำศัพท์ สำนวน วลีและประโยคภาษาอังกฤษพื้นฐานเพื่อการสื่อสารในระดับเริ่มต้น', 'มีทักษะภาษาอังกฤษตามมาตรฐาน CEFR ในระดับ A1', 'ทำงานร่วมกับผู้อื่น มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'gen004', code: '00-400-070-005', name: 'ภาษาอังกฤษ 1 (English 1)', credits: 3, category: 'GenEd', description: 'คำศัพท์ สำนวนและประโยคภาษาอังกฤษเพื่อการสื่อสารในระดับต้น ในสถานการณ์ต่าง ๆ ที่ใช้บ่อยในชีวิตประจำวัน การแลกเปลี่ยนข้อมูลอย่างง่ายในหัวข้อที่คุ้นเคย ข้อมูลส่วนตัว ครอบครัว การซื้อของ ภูมิศาสตร์ท้องถิ่น การจ้างงาน เรื่องที่เกี่ยวกับความต้องการเร่งด่วน การฝึกปฏิบัติการใช้ทักษะภาษาอังกฤษในการฟัง พูด อ่าน และเขียน ในบริบทที่คุ้นเคยและทำเป็นประจำ การมีปฏิสัมพันธ์กับผู้อื่นด้วยวิธีการและภาษาที่ง่าย ถูกต้อง เหมาะสมและไม่ซับซ้อน', clos: ['ใช้คำศัพท์ สำนวน วลีและประโยคภาษาอังกฤษพื้นฐาน เพื่อการสื่อสารในระดับเริ่มต้นตามสถานการณ์ต่างๆ ในชีวิตประจำวัน', 'ใช้ภาษาอังกฤษในการฟัง พูด อ่าน และเขียน ด้วยคำศัพท์ สำนวนและประโยคภาษาอังกฤษเพื่อการสื่อสารระดับต้น ในการมีปฏิสัมพันธ์กับผู้อื่นในสถานการณ์ต่างๆ ในชีวิตประจำวัน', 'มีทักษะภาษาอังกฤษตามมาตรฐาน CEFR ในระดับ A2', 'ทำงานร่วมกับผู้อื่น มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'gen005', code: '00-400-070-006', name: 'ภาษาอังกฤษ 2 (English 2)', credits: 3, category: 'GenEd', description: 'คำศัพท์ สำนวนและประโยคภาษาอังกฤษเพื่อการสื่อสารในระดับกลางในสถานการณ์ต่าง ๆ ที่คุ้นเคยและตนเองสนใจในชีวิตประจำวัน เรื่องที่คุ้นเคยเกี่ยวกับการทำงาน โรงเรียน การใช้เวลาว่าง การเข้าใจประเด็นหลักจากภาษามาตรฐานที่ชัดเจนการบรรยายประสบการณ์ เหตุการณ์ ความฝัน ความหวัง และความใฝ่ฝัน การให้เหตุผลสั้น ๆ การอธิบายความคิดเห็นและแผนการ การใช้ภาษาอังกฤษเพื่อการสื่อสารในระดับกลางและมีปฏิสัมพันธ์กับผู้อื่นในการรับมือกับสถานการณ์ต่าง ๆ ที่มักเกิดขึ้นระหว่างการเดินทางท่องเที่ยวในสถานที่ที่ผู้คนใช้ภาษาอังกฤษ การฝึกปฏิบัติการใช้ทักษะภาษาอังกฤษในการฟัง พูด อ่าน และเขียน เพื่อการสื่อสารในระดับกลางในสถานการณ์ต่าง ๆ ที่คุ้นเคยและตนเองสนใจในชีวิตประจำวัน', clos: ['ใช้คำศัพท์ สำนวนและประโยคภาษาอังกฤษเพื่อการสื่อสารระดับกลางในสถานการณ์ที่ตนเองสนใจในชีวิตประจำวัน', 'ใช้ภาษาอังกฤษในการฟัง พูด อ่าน และเขียน ด้วยใช้คำศัพท์ สำนวนและประโยคภาษาอังกฤษเพื่อการสื่อสารระดับกลางในสถานการณ์ที่ตนเองสนใจในชีวิตประจำวัน', 'มีทักษะภาษาอังกฤษตามมาตรฐาน CEFR ในระดับ B1', 'ทำงานร่วมกับผู้อื่น มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'gen006', code: '00-400-080-005', name: 'แนวคิดและทักษะนวัตกรรม (Innovation Idea and Competence)', credits: 3, category: 'GenEd', description: 'แนวคิดของนวัตกรรม หลักการจัดการนวัตกรรม ประเภทของนวัตกรรม ระบบนิเวศนวัตกรรม กระบวนการคิดเชิงออกแบบ ความคิดสร้างสรรค์และแรงกระตุ้นให้เกิดความคิดสร้างสรรค์ในการสร้างนวัตกรรม เครื่องมือในการคิดอย่างเป็นระบบ เครื่องมือสร้างต้นแบบ เทคโนโลยีสร้างต้นแบบอย่างรวดเร็ว การสร้างและนำเสนอโครงงานต้นแบบนวัตกรรม', clos: ['อธิบายแนวคิดและหลักการนวัตกรรม กระบวนการคิดเชิงออกแบบ การคิดอย่างเป็นระบบ หลักการจัดการนวัตกรรม เทคโนโลยีสร้างต้นแบบอย่างรวดเร็ว', 'เลือกเครื่องมือสร้างต้นแบบนวัตกรรมได้อย่างเหมาะสม', 'สร้างต้นแบบนวัตกรรมนำไปสู่การใช้งานจริงและเชิงพาณิชย์', 'ทำงานเป็นทีม รับฟังความคิดเห็นผู้อื่น เพื่อสรุปประเด็นในการพัฒนา นวัตกรรม', 'นำเสนอผลงานเชิงนวัตกรรมในหลากหลายรูปแบบ'] },
            { id: 'gen007', code: '00-400-090-001', name: 'การเป็นผู้ประกอบการและการนำเสนอขายงานสำหรับการสร้างธุรกิจใหม่ (Entrepreneurship and Pitching for New Business Creation)', credits: 3, category: 'GenEd', description: 'แนวคิดการเป็นผู้ประกอบการ จรรยาบรรณทางธุรกิจของผู้ประกอบการ การวางแผนธุรกิจ การวางแผนการเงิน การออมเพื่อความมั่นคง การประยุกต์ใช้เทคโนโลยีสารสนเทศและเครื่องมือในการนำเสนอรูปแบบทางธุรกิจใหม่ การเขียนแผนธุรกิจและแผนกลยุทธ์เพื่อการนำเสนอขายงาน เทคนิคการเจรจาต่อรอง การพัฒนาบุคลิกภาพเพื่อการนำเสนอขายงาน', clos: ['อธิบายแนวคิดการเป็นผู้ประกอบการ และจรรยาบรรณทางธุรกิจของผู้ประกอบการ', 'ใช้เทคโนโลยีสารสนเทศและเครื่องมือในการนำเสนอรูปแบบทางธุรกิจใหม่', 'เขียนแผนธุรกิจและแผนกลยุทธ์เพื่อการนำเสนอขายงาน', 'ใช้เทคนิคการเจรจาเพื่อการต่อรองทางธุรกิจ', 'แสดงออกถึงบุคลิกภาพเพื่อการนำเสนอขายงานสำหรับการสร้างธุรกิจใหม่', 'มีความรับผิดชอบ ทำงานเป็นทีม'] },
            { id: 'gen008', code: '00-400-100-008', name: 'รากเหง้า มทร.อีสาน (Root of RMUTI)', credits: 2, category: 'GenEd', description: 'วัฒนธรรมพื้นถิ่นอีสาน ฮีต 12 คอง 14 ประวัติศาสตร์ บุคคลสำคัญและศิษย์เก่า ของมหาวิทยาลัยเทคโนโลยีราชมงคลอีสาน อัตลักษณ์บัณฑิต การสร้างแนวคิดจิตอาสาเพื่อท้องถิ่น เป้าหมายการพัฒนาที่ยั่งยืน (SDGs) เพื่อชุมชนท้องถิ่น การวางแผนพัฒนาชุมชนท้องถิ่น', clos: ['บอกวัฒนธรรมพื้นถิ่นอีสาน ฮีต 12 คอง 14', 'บอกประวัติศาสตร์ของมหาวิทยาลัยเทคโนโลยีราชมงคลอีสาน', 'อธิบายแนวคิดจิตอาสาและเป้าหมายการพัฒนาที่ยั่งยืน (SDGs) เพื่อการพัฒนาชุมชนท้องถิ่น', 'สรุปและนำเสนอแนวคิดจากการลงพื้นที่ เพื่อพัฒนาชุมชนท้องถิ่น โดยเชื่อมโยงอัตลักษณ์บัณฑิตมหาวิทยาลัยเทคโนโลยีราชมงคลอีสาน', 'ยึดมั่นในสิ่งที่ถูกต้อง มีความรับผิดชอบ ทำงานเป็นทีม'] },
            { id: 'gen009', code: '00-400-100-009', name: 'ชุมชนนวัตกรรมสร้างสรรค์ (Creative Innovation Community)', credits: 3, category: 'GenEd', description: 'หลักการคิดเชิงออกแบบ องค์ประกอบหลักการคิดเชิงออกแบบ การคิดเชิงออกแบบกับชุมชน การระดมความคิด กระบวนการคิดเชิงออกแบบแบบมีส่วนร่วม การบูรณาการความรู้สิ่งแวดล้อมเพื่อชุมชน การสร้างสรรค์ผลงาน การนำเสนอผลงานอย่างมีส่วนร่วมกับชุมชน', clos: ['อธิบายหลักการคิดเชิงออกแบบกับชุมชน องค์ประกอบหลักของการคิดเชิงออกแบบชุมชน กระบวนการคิดเชิงออกแบบแบบมีส่วนร่วม', 'ใช้ความรู้การคิดเชิงออกแบบในการสร้างแนวทางหรือนวัตกรรมที่ตอบโจทย์กับชุมชนอย่างมีส่วนร่วม', 'ใช้ความรู้ ทักษะ จากศาสตร์ต่าง ๆ สร้างสรรค์แนวทางแก้ไข มาทดสอบ พัฒนา เพื่อให้เกิดประโยชน์กับชุมชน', 'สรุปและนำเสนอแนวคิดจากการลงพื้นที่ เพื่อพัฒนาชุมชนท้องถิ่น โดยเชื่อมโยงอัตลักษณ์บัณฑิตมหาวิทยาลัยเทคโนโลยีราชมงคลอีสาน', 'ยึดมั่นในสิ่งที่ถูกต้อง มีความรับผิดชอบ ทำงานเป็นทีม สื่อสารและ นำเสนองาน'] },
            
            // 2.1 กลุ่มวิชาพื้นฐานวิชาชีพ (CoreFund)
            { id: 'cf001', code: '02-005-011-102', name: 'แคลคูลัส 1 (Calculus 1)', credits: 3, category: 'CoreFund', description: 'ฟังก์ชัน ลิมิตและภาวะต่อเนื่อง การหาอนุพันธ์และการประยุกต์ ปริพันธ์ไม่จำกัดเขต เทคนิคการหาปริพันธ์ ปริพันธ์จำกัดเขตและการประยุกต์\nFunctions; limits and continuity; derivatives and applications; indefinite integrals; integration techniques; definite integrals and applications.', clos: ['อธิบายหลักการและทฤษฎีบทของฟังก์ชัน ลิมิต และภาวะต่อเนื่อง', 'หาอนุพันธ์และปริพันธ์ของฟังก์ชันต่าง ๆ', 'เลือกใช้เทคนิคการหาปริพันธ์ในการแก้ปัญหาอย่างถูกต้อง', 'นำความรู้เกี่ยวกับอนุพันธ์และปริพันธ์จำกัดเขตไปใช้ในการแก้ปัญหาเบื้องต้น', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'ทำงานร่วมกับผู้อื่นและมีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cf002', code: '02-005-011-103', name: 'แคลคูลัส 2 (Calculus 2)', credits: 3, category: 'CoreFund', description: 'ผิวกำลังสอง ฟังก์ชัน ลิมิตและภาวะต่อเนื่องของฟังก์ชันหลายตัวแปร อนุพันธ์ย่อยและการประยุกต์ ปริพันธ์หลายชั้นและการประยุกต์ ลำดับและอนุกรมอนันต์ \nQuadratic surface; function, limits, and continuity of function of several variables; partial differentiations and applications; multiple integrals and application; sequences and infinite series', clos: ['อธิบายหลักการและทฤษฎีบทของผิวกำลังสอง', 'อธิบายฟังก์ชันหลายตัวแปร', 'อธิบายนิยาม ทฤษฎีบทของลิมิต และภาวะต่อเนื่องของฟังก์ชันหลายตัวแปร', 'หาอนุพันธ์ย่อย และปริพันธ์หลายชั้น', 'นำความรู้เกี่ยวกับอนุพันธ์ย่อยและปริพันธ์หลายชั้นไปใช้ในการแก้ไขโจทย์ปัญหาทางวิทยาศาสตร', 'แก้ปัญหาลำดับและอนุกรมอนันต์อย่างง่าย', 'มีวินัย ตรงต่อเวลา และเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'ทำงานร่วมกับผู้อื่นและมีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cf003', code: '02-005-011-104', name: 'แคลคูลัส 3 (Calculus 3)', credits: 3, category: 'CoreFund', description: 'การวิเคราะห์เชิงเวกเตอร์ ฟังก์ชันแกมมาและบีตา อนุกรมฟูเรียร์ ผลการแปลงลาปลาซ ผลเฉลยในรูปอนุกรมกำลังของสมการเชิงอนุพันธ \nVector analysis; Gamma and Beta functions; Furier series; Laplace transform; solutions of differential equations in power series forms', clos: ['อธิบายนิยาม ทฤษฎีบทของฟังก์ชันแกมมาและบีตา', 'นำความรู้เกี่ยวกับฟังก์ชันแกมมาและบีตาไปใช้ในการแก้โจทย์ปัญหา', 'ใช้นิยาม ทฤษฎีบทของอนุกรมฟูเรียร์และการแปลงลาปลาซ ในการแก้โจทย์ปัญหา', 'นำนิยามและทฤษฎีบทของเวกเตอร์ไปใช้ในการแก้ปัญหาเวกเตอร์', 'นำอนุกรมกำลังไปประยุกต์ใช้หาผลเฉลยของสมการเชิงอนุพันธ', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'ทำงานร่วมกับผู้อื่นและมีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cf004', code: '02-005-022-101', name: 'เคมี 1 (Chemistry 1)', credits: 3, category: 'CoreFund', description: 'โครงสร้างอะตอม ตารางธาตุและสมบัติตามตารางธาตุ พันธะเคมี ปริมาณสารสัมพันธ์ แก๊ส ของเหลว สารละลาย ของแข็ง \nAtomic structure; periodic table and properties; chemical bonds; chemical stoichiometry; gases; liquids; solutions; solids', clos: ['เขียนการจัดเรียงอิเล็กตรอน เพื่ออธิบายสมบัติของธาตุ', 'บอกความแต่กต่างของพันธะเคมี และสมบัติของสารประกอบ', 'คำนวนความสัมพันธ์เชิงปริมาณของการเกิดปฏิกิริยาเคมี และการเตรียมสารละลาย', 'อธิบายตัวแปรต่าง ๆ ที่เกี่ยวข้องกับสมบัติของแก๊ส ของเหลว และของแข็ง', 'ใช้เทคโนโลยีสารสนเทศในการค้นคว้าทางเคมีจากแหล่งข้อมูลที่น่าเชื่อถือ', 'รับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cf005', code: '02-005-022-102', name: 'ปฏิบัติการเคมี 1 (Chemistry Laboratory 1)', credits: 1, category: 'CoreFund', description: 'การทดลองเกี่ยวกับเทคนิคพื้นฐานทางเคมี สมบัติของธาตุและสารประกอบ ปริมาณสารสัมพันธ์ สมบัติของแก๊ส ของเหลว สารละลาย โครงสร้างผลึกของของแข็ง \nExperiments relevant to basic techniques in chemistry; properties of elements and compounds; chemical stoichiometry; properties of gases, liquids, solutions; solid structures', clos: ['ใช้อุปกรณ์ เครื่องมือ และเทคนิคพื้นฐานได้อย่างถูกต้องตามหลักการทางเคมี', 'ปฏิบัติการทดลองเกี่ยวกับธาตุ สารประกอบ ปฏิกิริยาเคมี และสมบัติของสารแต่ละสถานะ', 'อธิบายผลการทดลองด้วยหลักการทางวิทยาศาสตร', 'ใช้เทคโนโลยีสารสนเทศในการค้นคว้าความรู้ทางเคมีจากแหล่งข้อมูลที่น่าเชื่อถือ', 'ทำงานร่วมกับผู้อื่น และมีความรับผิดชอบต่องานที่ได้รับมอบหมาย'] },
            { id: 'cf006', code: '02-005-022-103', name: 'เคมี 2 (Chemistry 2)', credits: 3, category: 'CoreFund', description: 'อุณหพลศาสตร์ จลนศาสตร์เคมี สมดุลเคมี สมดุลไอออนในน้ำ เคมีไฟฟ้า เคมีนิวเคลียร์ เคมีอินทรีย์เบื้องต้น \nThermodynamics; chemical kinetics; chemical equilibrium; ionic equilibrium; electrochemistry; nuclear chemistry; elementary organic chemistry', clos: ['อธิบายกฎของอุณหพลศาสตร์ ปฏิกิริยารีดอกซ์ และปฏิกิริยาของสารอินทรีย', 'เขียนกฎอัตรา และแผนภาพเซลล์ไฟฟ้าเคมี', 'ระบุประเภทของกรด เบส เกลือ เซลล์ไฟฟ้าเคมี ปฏิกิริยานิวเคลียร์ และสารประกอบไฮโดรคาร์บอน', 'คำนวณอัตราการเกิดปฏิกิริยา ค่าครึ่งชีวิต ค่าคงที่สมดุล ค่าพีเอชของสารละลาย และค่าศักย์ไฟฟ้ามาตรฐาน', 'ใช้เทคโนโลยีสารสนเทศในการค้นคว้าความรู้ทางเคมีจากแหล่งข้อมูลที่น่าเชื่อถือ', 'รับผิดชอบต่องานที่ได้รับมอบหมาย'] },
            { id: 'cf007', code: '02-005-022-104', name: 'ปฏิบัติการเคมี 2 (Chemistry Laboratory 2)', credits: 1, category: 'CoreFund', description: 'การทดลองเกี่ยวกับอุณหพลศาสตร์ อัตราการเกิดปฏิกิริยาเคมี สมดุลเคมี คุณสมบัติของกรด เบส และเกลือ การไทเทรต ปฏิกิริยาเคมี เคมีไฟฟ้า เคมีอินทรีย์เบื้องต้น \nExperiments relevant to thermodynamics; chemical kinetics; chemical equilibrium; properties of acid, base and salt; titration; chemical reactions; electrochemistry; elementary organic chemistry', clos: ['ใช้อุปกรณ์ เครื่องมือพื้นฐาน และเทคนิคทางเคมีได้อย่างถูกต้อง', 'ปฏิบัติการทดลองการหาค่าความร้อนของปฏิกิริยาเคมี ค่าศักย์ไฟฟ้า และเซลล์ไฟฟ้าเคมี', 'อธิบายปัจจัยที่มีผลต่ออัตราการเกิดปฏิกิริยาเคมี และสมดุลเคมี', 'ระบุความเป็นกรด เบส เกลือ และประเภทสารประกอบไฮโดรคาร์บอน', 'ไทเทรตหาความเข้มข้นของสารละลายกรด เบส', 'อภิปรายผลการทดลองด้วยหลักการทางวิทยาศาสตร', 'ปฏิบัติการตามแผนงานที่วางไว้', 'ใช้เทคโนโลยีสารสนเทศในการค้นคว้าความรู้ทางเคมีจากแหล่งข้อมูลที่น่าเชื่อถือ', 'ทำงานร่วมกับผู้อื่น และมีความรับผิดชอบต่องานที่ได้รับมอบหมาย'] },
            { id: 'cf008', code: '02-005-033-105', name: 'ฟิสิกส์พื้นฐาน (Fundamentals of Physics)', credits: 3, category: 'CoreFund', description: 'หน่วยวัดทางฟิสิกส์ กลศาสตร์ของอนุภาค โมเมนตัมและการดล งานและพลังงาน กลศาสตร์ของไหล ความร้อน คลื่นและคลื่นเสียง แม่เหล็กไฟฟ้า ทัศนศาสตร์ นิวเคลียร์ฟิสิกส์ \nUnits of physics measurement; particles mechanics; momentum and impulse; work and energy; fluid mechanics; heat; waves and sound waves; electromagnetism; optics; nuclear physics', clos: ['บอกความหมายของปริมาณทางฟิสิกส์เบื้องต้น', 'อธิบายการเปลี่ยนแปลงทางกลศาสตร์ พลศาสตร์ของวัตถุ สมบัติเชิงกลของสสาร ความร้อนและอุณหพลศาสตร์ สมบัติของคลื่นแม่เหล็กไฟฟ้า ทัศนศาสตร์ และนิวเคลียร์ฟิสิกส์', 'คำนวณการเปลี่ยนแปลงทางกลศาสตร์ของวัตถุ กลศาสตร์ของไหล คลื่นและคลื่นเสียง', 'แปรผลและนำข้อมูลทางฟิสิกส์ในรูปแบบมาตรฐานจากตาราง กราฟ และแผนภูมิไปใช้ได้อย่างถูกต้อง', 'มีวินัย ตรงต่อเวลา และเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cf009', code: '02-005-033-106', name: 'ปฏิบัติการฟิสิกส์พื้นฐาน (Fundamentals of Physics Laboratory)', credits: 1, category: 'CoreFund', description: 'ปฏิบัติการทดลองเกี่ยวกับหน่วยวัดทางฟิสิกส์ กลศาสตร์ของอนุภาค โมเมนตัมและการดล งานและพลังงาน กลศาสตร์ของไหล ความร้อน คลื่นและคลื่นเสียง แม่เหล็กไฟฟ้า ทัศนศาสตร์ นิวเคลียร์ฟิสิกส์ \nExperiments on units of physics measurement; particles mechanics; momentum and impulse; work and energy; fluid mechanics; heat; waves and sound waves; electromagnetism; optics; nuclear physics', clos: ['ใช้อุปกรณ์ และเครื่องมือพื้นฐานทางฟิสิกส์ได้อย่างถูกต้อง', 'ทำการทดลองเกี่ยวกับหน่วยวัดทางฟิสิกส์ กลศาสตร์ของอนุภาคโมเมนตัมและการดล งานและพลังงาน กลศาสตร์ของไหล ความร้อน คลื่นและคลื่นเสียง แม่เหล็กไฟฟ้า ทัศนศาสตร์และนิวเคลียร์ฟิสิกส์'] },
            { id: 'cf010', code: '02-005-055-204', name: 'สถิติ 1 (Statistic 1)', credits: 3, category: 'CoreFund', description: 'สถิติเชิงพรรณนา ความน่าจะเป็น ตัวแปรสุ่มและการแจกแจง การสุ่มตัวอย่างและการแจกแจงของกลุ่มตัวอย่าง การประมาณค่า การทดสอบสมมติฐาน การทดสอบไคกำลังสอง การแปลความหมายข้อมูลจาก การใช้โปรแกรมทางด้านสถิติ \nDescriptive statistics; probability; random variables and distributions; sampling and distribution of samples; estimations; hypothesis testing; Chi-square test; data interpretation using statistical programs', clos: ['อธิบายหลักการสถิติเชิงพรรณนา และความน่าจะเป็น', 'เลือกใช้ทฤษฎีตัวแปรสุ่มและการแจกแจงของกลุ่มตัวอย่าง การประมาณค่าและการทดสอบสมมติฐาน 1 ประชากร และการทดสอบไคกำลังสอง', 'นำทฤษฎีและโปรแกรมด้านสถิติเพื่อประมวลผลและแปลผลไปใช้ในการแก้โจทย์ปัญหาทางด้านวิทยาศาสตร์และเทคโนโลยีได้อย่างถูกต้อง', 'ปฏิบัติตามระเบียบวินัยของนักศึกษา', 'มีความซื่อสัตย์ สุจริต ต่อตัวเองและผู้อื่น'] },
            { id: 'cf011', code: '02-005-055-205', name: 'สถิติ 2 (Statistic 2)', credits: 3, category: 'CoreFund', description: 'การแจกแจงกลุ่มตัวอย่าง การประมาณค่า การทดสอบสมมติฐาน การวิเคราะห์ความแปรปรวน การวิเคราะห์การถดถอยและสหสัมพันธ์ การแปลความหมายจากผลการใช้โปรแกรมทางด้านสถิติ \nSample distribution; estimations; hypothesis testing; analysis of variances; regression and correlation analysis; interpretation of results from the use of statistical programs', clos: ['อธิบายหลักการตัวแปรสุ่มและการแจกแจงของกลุ่มตัวอย่าง 2 ประชากร', 'เลือกใช้ทฤษฎีของตัวแปรสุ่มและการแจกแจงกลุ่มตัวอย่าง การประมาณค่าและการทดสอบสมมติฐาน 2 ประชากร การวิเคราะห์ความแปรปรวนและการวิเคราะห์การถดถอยและสหสัมพันธ์', 'นำทฤษฎีและโปรแกรมด้านสถิติเพื่อประมวลผลและแปลผลไปใช้ในการแก้โจทย์ปัญหาทางด้านวิทยาศาสตร์และเทคโนโลยีได้อย่างถูกต้อง', 'ปฏิบัติตามระเบียบวินัยของนักศึกษา', 'มีความซื่อสัตย์ สุจริต ต่อตัวเองและผู้อื่น'] },
            { id: 'cf012', code: '02-005-055-306', name: 'การออกแบบการทดลอง (Design of Experiments)', credits: 3, category: 'CoreFund', description: 'หลักการในการวางแผนการทดลอง แผนการทดลองแบบสุ่มสมบูรณ์ แผนการทดลองแบบบล็อกสุ่ม การทดลอง ที่มีหลายปัจจัย การทดลองแบบแฟกทอเรียล แผนการทดลองแบบสปลิทพลอต การวิเคราะห์ความแปรปรวนร่วม การใช้โปรแกรมทางด้านสถิติและแปลความหมาย \nExperimental planning concepts; completely randomized designs; randomized complete block designs; multifactorial experiments; factorial experiments; split plot designs; analysis of covariances; use of statistical programs and interpretations of results', clos: ['อธิบายหลักการในการวางแผนการทดลองแบบสุ่มสมบูรณ์ แผนการทดลองแบบบล็อกสุ่มสมบูรณ์ การทดลองที่มีหลายปัจจัย การทดลองแบบแฟกทอเรียล แผนการทดลองแบบสปลิทพลอต และการวิเคราะห์ความแปรปรวนร่วมได้', 'เลือกใช้ทฤษฎีแผนการทดลองแบบสุ่มสมบูรณ์ แผนการทดลองแบบบล็อกสุ่มสมบูรณ์ การทดลองที่มีหลายปัจจัย การทดลองแบบแฟกทอเรียล แผนการทดลองแบบสปลิทพลอตและการวิเคราะห์ความแปรปรวนร่วม', 'นำทฤษฎีและโปรแกรมด้านการออกแบบการทดลองเพื่อประมวลผลและแปลผลไปใช้ในการแก้โจทย์ปัญหาทางด้านวิทยาศาสตร์และเกษตรศาสตร์ได้อย่างถูกต้อง', 'ปฏิบัติตามระเบียบวินัยของนักศึกษา', 'มีความซื่อสัตย์ สุจริต ต่อตัวเองและผู้อื่น'] },
            // 2.2 กลุ่มวิชาบังคับ (CoreComp)
            { id: 'cc001', code: 'xx-xxx-xxx-xxx', name: 'หลักการคณิตศาสตร์ (Principles of Mathematics)', credits: 3, category: 'CoreComp', description: 'ตรรกศาสตร์เชิงสัญลักษณ์ ตัวบ่งปริมาณ ระเบียบวิธีพิสูจน์ทางคณิตศาสตร์ การพิสูจน์โดยตรง การพิสูจน์โดยแย้งสลับที่ การพิสูจน์โดยข้อขัดแย้ง และการอุปนัยเชิงคณิตศาสตร์ ทฤษฎีเซตเบื้องต้น ความสัมพันธ์สมมูลและฟังก์ชัน\nSymbolic logic; quantifiers; methods of mathematical proof: direct proof, contrapositive, contradiction, and induction; basic set theory; equivalence relations and functions.', clos: ['อธิบายโครงสร้างของประโยคตรรกศาสตร์และรูปแบบการให้เหตุผลที่สมเหตุสมผลได้','เขียนบทพิสูจน์ทางคณิตศาสตร์โดยใช้วิธีการพิสูจน์แบบต่าง ๆ ได้อย่างถูกต้องตามหลักตรรกศาสตร์', 'ตรวจสอบความถูกต้องของข้อความคาดการณ์ทางคณิตศาสตร์ได้', 'ใช้หลักการอุปนัยเชิงคณิตศาสตร์ในการพิสูจน์คุณสมบัติของจำนวนนับได้', 'วิเคราะห์คุณสมบัติของเซต ความสัมพันธ์ และฟังก์ชัน ผ่านการพิสูจน์ได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc002', code: 'xx-xxx-xxx-xxx', name: 'วิยุตคณิต (Discrete Mathematics)', credits: 3, category: 'CoreComp', description: 'เซตและความสัมพันธ์ หลักการนับและความน่าจะเป็นแบบไม่ต่อเนื่อง ทฤษฎีกราฟเบื้องต้น ต้นไม้ พีชคณิตบูลีน ตรรกศาสตร์สำหรับวิทยาการคอมพิวเตอร์ \nSets and relations; counting principles and discrete probability; introduction to graph theory; trees; Boolean algebra; logic for computer science', clos: ['ใช้หลักการนับ การจัดหมู่ และการเรียงสับเปลี่ยนในการแก้ปัญหาความน่าจะเป็นแบบไม่ต่อเนื่องได้', 'อธิบายและวิเคราะห์โครงสร้างกราฟและต้นไม้ และนำไปใช้จำลองปัญหาจริงได้', 'ใช้พีชคณิตบูลีนในการออกแบบวงจรตรรกะเบื้องต้นได้', 'เขียนขั้นตอนวิธี (Algorithm) เพื่อแก้ปัญหาทางวิยุตคณิตได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc003', code: 'xx-xxx-xxx-xxx', name: 'สมการเชิงอนุพันธ์เบื้องต้น (Elementary Differential Equations)', credits: 3, category: 'CoreComp', description: 'สมการเชิงอนุพันธ์สามัญอันดับหนึ่ง สมการเชิงอนุพันธ์เชิงเส้นอันดับสูงที่มีสัมประสิทธิ์เป็นค่าคงตัว การแปลงลาปลาซ ระบบสมการเชิงอนุพันธ์เชิงเส้น การประยุกต์สมการเชิงอนุพันธ์ในแบบจำลองทางกายภาพ \nFirst-order ordinary differential equations; higher-order linear differential equations with constant coefficients; Laplace transforms; systems of linear differential equations; applications of differential equations in physical models', clos: ['จำแนกประเภทและอันดับของสมการเชิงอนุพันธ์ได้', 'หาผลเฉลยของสมการเชิงอนุพันธ์สามัญอันดับหนึ่งและอันดับสูงด้วยวิธีการที่เหมาะสมได้', 'ใช้การแปลงลาปลาซในการแก้ปัญหาค่าเริ่มต้นและระบบสมการเชิงอนุพันธ์ได้', 'สร้างแบบจำลองทางคณิตศาสตร์ด้วยสมการเชิงอนุพันธ์เพื่ออธิบายปรากฏการณ์ทางฟิสิกส์หรือวิศวกรรมอย่างง่ายได้', 'วิเคราะห์พฤติกรรมของผลเฉลยและตีความหมายในบริบทของการประยุกต์ใช้ได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc004', code: 'xx-xxx-xxx-xxx', name: 'พีชคณิตเชิงเส้นขั้นแนะนำ (Introduction to Linear Algebra)', credits: 3, category: 'CoreComp', description: 'ระบบสมการเชิงเส้น เมทริกซ์และดีเทอร์มิแนนท์ ปริภูมิเวกเตอร์ การแปลงเชิงเส้น ค่าลักษณะเฉพาะและเวกเตอร์ลักษณะเฉพาะ การทำให้เป็นเมทริกซ์ทแยงมุม การประยุกต์พีชคณิตเชิงเส้นในการวิเคราะห์ข้อมูล \nSystems of linear equations; matrices and determinants; vector spaces; linear transformations; eigenvalues and eigenvectors; diagonalization; applications of linear algebra in data analysis', clos: ['หาผลเฉลยของระบบสมการเชิงเส้นโดยใช้เมทริกซ์และวิธีการกำจัดแบบเกาส์ได้', 'อธิบายและตรวจสอบคุณสมบัติของปริภูมิเวกเตอร์ ปริภูมิย่อย และความเป็นอิสระเชิงเส้นได้', 'คำนวณหาค่าลักษณะเฉพาะและเวกเตอร์ลักษณะเฉพาะ และทำการแปลงเมทริกซ์ให้เป็นเมทริกซ์ทแยงมุมได้', 'อธิบายความเชื่อมโยงแนวคิดของการแปลงเชิงเส้นกับเมทริกซ์ได้', 'ใช้พีชคณิตเชิงเส้นในการแก้ปัญหาพื้นฐานด้านวิทยาการข้อมูล เช่น การลดมิติข้อมูล หรือการประมวลผลภาพเบื้องต้นได้', 'ใช้งานซอฟต์แวร์คำนวณทางคณิตศาสตร์ช่วยในการแก้ปัญหาพีชคณิตเชิงเส้นได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc005', code: 'xx-xxx-xxx-xxx', name: 'พีชคณิตนามธรรมขั้นแนะนำ (Introduction to Abstract Algebra)', credits: 3, category: 'CoreComp', description: 'โครงสร้างทางพีชคณิตพื้นฐาน กรุป กรุปย่อย กรุปวัฏจักร การเรียงสับเปลี่ยน โคเซตและทฤษฎีบทของลากรองจ์ กรุปปกติและกรุปผลหาร สาทิสสัณฐานของกรุป ริง ริงย่อย ไอดีลและริงผลหาร สาทิสสัณฐานของริง อินทิกรัลโดเมนและฟิลด์ \nBasic algebraic structures; groups, subgroups, and cyclic groups; permutations; cosets and Lagrange’s theorem; normal subgroups and quotient groups; group homomorphisms; rings, subrings, ideals, and quotient rings; ring homomorphisms; integral domains and fields', clos: ['จำแนกและยกตัวอย่างโครงสร้างทางพีชคณิตแบบต่าง ๆ ได้อย่างถูกต้อง', 'พิสูจน์ทฤษฎีบทพื้นฐานเกี่ยวกับกรุป ริง อินทิกรัลโดเมนและฟิลด์ได้', 'วิเคราะห์ความสัมพันธ์ระหว่างโครงสร้างย่อยกับโครงสร้างหลักสำหรับโครงสร้างพีชคณิตพื้นฐานได้', 'ใช้แนวคิดเรื่องสาทิสสัณฐานเพื่อตรวจสอบความสมสัณฐานของโครงสร้างทางพีชคณิตได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc006', code: 'xx-xxx-xxx-xxx', name: 'การวิเคราะห์เชิงจริงขั้นแนะนำ (Introduction to Real Analysis)', credits: 3, category: 'CoreComp', description: 'ระบบจำนวนจริง สมบัติความบริบูรณ์ โทโพโลยีบนเส้นจำนวนจริง ลำดับและการลู่เข้าของลำดับจำนวนจริง อนุกรมของจำนวนจริง ลิมิตและความต่อเนื่องของฟังก์ชัน อนุพันธ์ของฟังก์ชันบนจำนวนจริง ทฤษฎีบทค่ามัชฌิม ปริพันธ์ของรีมันน์ ลำดับและอนุกรมของฟังก์ชัน \nReal number system; completeness property; topology on the real line; sequences and convergence of real numbers; series of real numbers; limits and continuity of functions; derivatives of real-valued functions; Mean Value Theorem; Riemann integral; sequences and series of functions', clos: ['อธิบายโครงสร้างและสมบัติความบริบูรณ์ของระบบจำนวนจริงได้อย่างชัดเจน', 'พิสูจน์การลู่เข้าของลำดับและอนุกรมโดยใช้นิยามและเกณฑ์ต่าง ๆ ได้', 'วิเคราะห์ความต่อเนื่องและความสามารถในการหาอนุพันธ์ของฟังก์ชันได้', 'ใช้ทฤษฎีบทค่ามัชฌิมและทฤษฎีบทพื้นฐานของแคลคูลัสในการพิสูจน์ประพจน์ทางคณิตศาสตร์ได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc007', code: 'xx-xxx-xxx-xxx', name: 'วิธีเชิงตัวเลขเบื้องต้น (Elementary Numerical Methods)', credits: 3, category: 'CoreComp', description: 'การวิเคราะห์ความคลาดเคลื่อน ผลเฉลยของสมการไม่เชิงเส้น ผลเฉลยของระบบสมการเชิงเส้น การประมาณค่าในช่วง การประมาณโดยวิธีกำลังสองน้อยสุด การหาอนุพันธ์และปริพันธ์เชิงตัวเลข ผลเฉลยเชิงตัวเลขของสมการเชิงอนุพันธ์ \nError analysis, solutions of nonlinear equations, solutions of systems of linear equations, interpolation, least square approximation, numerical differentiation and integration, numerical solutions of differential equations', clos: ['อธิบายแหล่งที่มาของความคลาดเคลื่อนในการคำนวณและผลกระทบต่อผลลัพธ์ได้', 'เลือกใช้วิธีเชิงตัวเลขที่เหมาะสมในการหาผลเฉลยของปัญหาทางคณิตศาสตร์ที่ไม่สามารถหาผลเฉลยแม่นตรงได้', 'คำนวณหาผลเฉลยของระบบสมการเชิงเส้นและไม่เชิงเส้นด้วยระเบียบวิธีทำซ้ำได้', 'เขียนโปรแกรมคอมพิวเตอร์เพื่อดำเนินการตามขั้นตอนวิธีเชิงตัวเลขได้', 'วิเคราะห์และเปรียบเทียบประสิทธิภาพของวิธีเชิงตัวเลขต่าง ๆ ได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc008', code: 'xx-xxx-xxx-xxx', name: 'การสร้างแบบจำลองทางคณิตศาสตร์ (Mathematical Model)', credits: 3, category: 'CoreComp', description: 'กระบวนการสร้างแบบจำลองทางคณิตศาสตร์ การแปลงปัญหาจริงเป็นปัญหาคณิตศาสตร์ แบบจำลองการเติบโตและการเสื่อมสลาย แบบจำลองการแพร่กระจาย กรณีศึกษาการแก้ปัญหาในระบบอุตสาหกรรม โลจิสติกส์ และการจัดการพลังงาน \nMathematical modelling process; translating real-world problems into mathematical problems; growth and decay models; diffusion models; case studies on problem solving in industrial systems, logistics, and energy management', clos: ['อธิบายกระบวนการสร้างแบบจำลองทางคณิตศาสตร์และวงจรการแก้ปัญหาได้', 'แปลงโจทย์ปัญหาจริงในอุตสาหกรรมให้เป็นสมการหรือแบบจำลองทางคณิตศาสตร์ได้', 'วิเคราะห์และหาผลเฉลยจากแบบจำลองเพื่อทำนายพฤติกรรมของระบบได้', 'ประเมินความสมเหตุสมผลและข้อจำกัดของแบบจำลองที่สร้างขึ้นได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc009', code: 'xx-xxx-xxx-xxx', name: 'การหาค่าเหมาะสมขั้นแนะนำ (Introduction to Optimizations)', credits: 3, category: 'CoreComp', description: 'การกำหนดโจทย์ปัญหาค่าเหมาะสม กำหนดการเชิงเส้น วิธีซิมเพล็กซ์ ทฤษฎีภาวะคู่กัน กำหนดการที่ไม่ใช่เชิงเส้นเบื้องต้น การหาค่าเหมาะสมแบบไม่มีเงื่อนไข การประยุกต์ใช้ในการจัดสรรทรัพยากรและการวางแผนการผลิต \nFormulating optimization problems; linear programming; simplex method; duality theory; introduction to non-linear programming; unconstrained optimization; applications in resource allocation and production planning', clos: ['จำแนกประเภทของปัญหาค่าเหมาะสมได้', 'สร้างแบบจำลองทางคณิตศาสตร์สำหรับปัญหากำหนดการเชิงเส้นและปัญหาค่าเหมาะสมอื่น ๆ ได้', 'หาผลเฉลยที่ดีที่สุดโดยใช้วิธีคำนวณแบบต่าง ๆ ได้', 'ใช้ซอฟต์แวร์คอมพิวเตอร์ช่วยในการหาผลเฉลยของปัญหาขนาดใหญ่ได้', 'วิเคราะห์ความไวเพื่อดูผลกระทบของการเปลี่ยนแปลงตัวแปรได้', 'ใช้เทคนิคการหาค่าเหมาะสมในการบริหารจัดการทรัพยากรหรือการผลิตในอุตสาหกรรมได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc010', code: 'xx-xxx-xxx-xxx', name: 'คณิตศาสตร์สำหรับการเรียนรู้ของเครื่อง (Mathematics for Machine Learning)', credits: 3, category: 'CoreComp', description: 'พีชคณิตเชิงเส้นและเรขาคณิตวิเคราะห์สำหรับการวิเคราะห์ข้อมูล การแยกตัวประกอบเมทริกซ์ แคลคูลัสของเวกเตอร์และการหาอนุพันธ์ย่อย ทฤษฎีความน่าจะเป็นและการแจกแจงแบบต่อเนื่อง การหาค่าเหมาะสมที่สุดแบบต่อเนื่อง ทฤษฎีเบื้องหลังอัลกอริทึมการเรียนรู้ของเครื่อง \nLinear algebra and analytic geometry for data analysis; matrix decompositions; vector calculus and partial derivatives; probability theory and continuous distributions; continuous optimization; theoretical foundations of machine learning algorithms', clos: ['อธิบายแนวคิดพื้นฐานทางคณิตศาสตร์ที่ประกอบด้วยพีชคณิตเชิงเส้น เรขาคณิตวิเคราะห์ และความน่าจะเป็น สำหรับการเรียนรู้ของเครื่องได้', 'คำนวณการแยกตัวประกอบเมทริกซ์ด้วยมือเพื่อแสดงความเข้าใจในกระบวนการทางคณิตศาสตร์ได้', 'พิสูจน์และอธิบายที่มาของสมการในการหาค่าเหมาะสมสำหรับฟังก์ชันค่าสูญเสียได้', 'วิเคราะห์โครงสร้างทางคณิตศาสตร์ของขั้นตอนวิธีเพื่อเชื่อมโยงทฤษฎีสู่หลักการทำงานของตัวแบบได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc011', code: 'xx-xxx-xxx-xxx', name: 'การสื่อสารทางคณิตศาสตร์และการใช้เครื่องมือดิจิทัล (Mathematical Communication and Digital Tools)', credits: 2, category: 'CoreComp', description: 'หลักการสื่อสารทางคณิตศาสตร์ การเขียนเอกสารทางวิชาการและคณิตศาสตร์ด้วยโปรแกรมเรียงพิมพ์ทางคณิตศาสตร์ การสร้างสมการและสัญลักษณ์ทางคณิตศาสตร์ การสร้างงานนำเสนอด้วยบีมเมอร์ หรือซอฟต์แวร์นำเสนอสมัยใหม่ เทคนิคการเล่าเรื่องด้วยข้อมูล การใช้เครื่องมือดิจิทัลเพื่อสร้างภาพนิทัศน์ข้อมูลทางคณิตศาสตร์ การนำเสนอผลงานวิชาการและโครงงานอย่างมีประสิทธิภาพ จรรยาบรรณในการนำเสนอข้อมูล \nPrinciples of mathematical communication; writing academic and mathematical documents using mathematical typesetting software; creating mathematical equations and symbols; creating presentations using Beamer or modern presentation software; data storytelling techniques; using digital tools for mathematical data visualization; effective presentation of academic works and projects; ethics in data presentation', clos: ['อธิบายหลักการสื่อสารทางคณิตศาสตร์และการเขียนเอกสารวิชาการที่ถูกต้องตามมาตรฐานได้', 'ใช้งานโปรแกรมเรียงพิมพ์ทางคณิตศาสตร์ในการพิมพ์เอกสาร บทความ และสร้างสมการทางคณิตศาสตร์ที่ซับซ้อนได้อย่างถูกต้องสวยงาม', 'ออกแบบและสร้างสื่อนำเสนอโดยใช้บีมเมอร์ หรือเครื่องมือดิจิทัลอื่น ๆ ได้อย่างมืออาชีพและน่าสนใจ', 'ประยุกต์ใช้เทคนิคการเล่าเรื่องเพื่ออธิบายข้อมูลหรือผลลัพธ์ทางคณิตศาสตร์ให้เข้าใจง่าย', 'ตระหนักถึงจรรยาบรรณทางวิชาการ การอ้างอิง และความถูกต้องของข้อมูลที่นำเสนอ'] },
            { id: 'cc012', code: 'xx-xxx-xxx-xxx', name: 'วิทยาการคอมพิวเตอร์เบื้องต้นสำหรับคณิตศาสตร์ประยุกต์ (Foundation of Computer Science for Applied Mathematics)', credits: 3, category: 'CoreComp', description: 'โครงสร้างและสถาปัตยกรรมคอมพิวเตอร์ ระบบปฏิบัติการ เครือข่ายคอมพิวเตอร์และความปลอดภัยไซเบอร์เบื้องต้น โครงสร้างข้อมูลและอัลกอริทึม ฐานข้อมูล จริยธรรมและกฎหมายทางคอมพิวเตอร์ \nComputer structure and architecture; operating systems; computer networks and introduction to cybersecurity; data structures and algorithms; databases; computer ethics and law', clos: ['อธิบายองค์ประกอบหลักและการทำงานร่วมกันของฮาร์ดแวร์และซอฟต์แวร์คอมพิวเตอร์ได้', 'อธิบายหลักการพื้นฐานของระบบปฏิบัติการและเครือข่ายคอมพิวเตอร์ได้', 'จำแนกประเภทของโครงสร้างข้อมูลและเลือกใช้อัลกอริทึมที่เหมาะสมกับปัญหาได้', 'อธิบายแนวคิดเรื่องความปลอดภัยไซเบอร์และระบุภัยคุกคามทางคอมพิวเตอร์เบื้องต้นได้', 'ระบุแหล่งเรียนรู้และแนวโน้มของเทคโนโลยีคอมพิวเตอร์สมัยใหม่ พร้อมยกตัวอย่างผลกระทบต่อสังคมได้', 'วิเคราะห์ประเด็นทางจริยธรรมและกฎหมายที่เกี่ยวข้องกับการใช้งานคอมพิวเตอร์และเทคโนโลยีสารสนเทศได้', 'แสดงความรับผิดชอบต่อตนเองและผู้อื่นผ่านการส่งงานตามกำหนด การปฏิบัติตามข้อตกลงของรายวิชา และการมีส่วนร่วมอย่างเหมาะสมในกิจกรรมการเรียนรู้'] },
            { id: 'cc013', code: 'xx-xxx-xxx-xxx', name: 'การเขียนโปรแกรมเบื้องต้นสำหรับคณิตศาสตร์ประยุกต์ (Introduction to Programming for Applied Mathematics)', credits: 3, category: 'CoreComp', description: 'แนวคิดพื้นฐานของการเขียนโปรแกรม โครงสร้างภาษาไวยากรณ์ ชนิดข้อมูล ตัวแปร นิพจน์ คำสั่งควบคุมการทำงาน การเขียนฟังก์ชัน การจัดการอาร์เรย์และสตริง การแก้ปัญหาพื้นฐานด้วยอัลกอริทึมทางคอมพิวเตอร์ \nBasic concepts of programming; syntax and data types; variables and expressions; control structures; functions; array and string manipulation; solving basic problems using computer algorithms', clos: ['อธิบายโครงสร้างและไวยากรณ์พื้นฐานของภาษาโปรแกรมคอมพิวเตอร์ได้', 'เขียนโปรแกรมโดยใช้ตัวแปร นิพจน์ และคำสั่งควบคุม (เงื่อนไขและการทำซ้ำ) ได้', 'ออกแบบและพัฒนาฟังก์ชันเพื่อแบ่งย่อยงานและเพิ่มความสามารถในการใช้ซ้ำของโค้ดได้', 'ใช้โครงสร้างข้อมูลแบบอาร์เรย์และสตริงในการจัดการข้อมูลเบื้องต้นได้', 'วิเคราะห์โจทย์ปัญหาและเขียนอัลกอริทึมหรือผังงานเพื่อแก้ปัญหาได้อย่างเป็นขั้นตอน', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc014', code: 'xx-xxx-xxx-xxx', name: 'การเขียนโปรแกรมสำหรับคณิตศาสตร์ประยุกต์ 1 (Programming for Applied Mathematics 1)', credits: 3, category: 'CoreComp', description: 'การเขียนโปรแกรมภาษาไพธอนสำหรับคณิตศาสตร์ประยุกต์ โครงสร้างข้อมูลขั้นสูง การจัดการและทำความสะอาดข้อมูลด้วยไลบรารีมาตรฐาน การแสดงผลข้อมูลด้วยกราฟและแผนภาพ การทำงานกับไฟล์ข้อมูลประเภทต่าง ๆ \nPython programming for applied mathematics; advanced data structures; data manipulation and cleaning using standard libraries; data visualization; working with various data file formats', clos: ['ใช้ภาษาไพธอน และไลบรารีพื้นฐานในการจัดการโครงสร้างข้อมูลได้', 'ปฏิบัติการนำเข้าข้อมูล ทำความสะอาดข้อมูล และเตรียมข้อมูลสำหรับวิเคราะห์ได้', 'สร้างภาพนิทัศน์ข้อมูลด้วยไลบรารีเพื่อสื่อสารข้อมูลได้', 'เขียนโปรแกรมเพื่ออ่านและเขียนไฟล์ข้อมูลรูปแบบต่าง ๆ ได้', 'ใช้ทักษะการเขียนโปรแกรมในการวิเคราะห์ข้อมูลเบื้องต้นจากชุดข้อมูลจริงได้', 'แสวงหาความรู้เพิ่มเติมเกี่ยวกับไลบรารีใหม่ ๆ และแบ่งปันความรู้กับเพื่อนร่วมชั้นได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc015', code: 'xx-xxx-xxx-xxx', name: 'การเขียนโปรแกรมสำหรับคณิตศาสตร์ประยุกต์ 2 (Programming for Applied Mathematics 2)', credits: 3, category: 'CoreComp', description: 'การเขียนโปรแกรมเชิงวัตถุ การเชื่อมต่อฐานข้อมูล SQL และ NoSQL การดึงข้อมูลจากเว็บเบื้องต้น การพัฒนาเว็บแอปพลิเคชันอย่างง่ายสำหรับแสดงผลข้อมูล \nObject-oriented programming; SQL and NoSQL database connectivity; introduction to web scraping; developing simple web applications for data dashboards', clos: ['ใช้หลักการเขียนโปรแกรมเชิงวัตถุในการพัฒนาระบบซอฟต์แวร์ขนาดเล็กได้', 'เขียนคำสั่ง SQL เพื่อจัดการและดึงข้อมูลจากระบบฐานข้อมูลเชิงสัมพันธ์ได้', 'ปฏิบัติการดึงข้อมูลจากเว็บไซต์อย่างมีจริยธรรมและถูกต้องตามกฎหมาย', 'พัฒนา Web Application หรือ Dashboard อย่างง่าย เพื่อนำเสนอผลการวิเคราะห์ข้อมูลได้', 'บูรณาการความรู้ด้านการเขียนโปรแกรมและฐานข้อมูลเพื่อสร้างโครงงานวิทยาการข้อมูลได้', 'ตระหนักถึงความปลอดภัยของข้อมูลและจริยธรรมในการเข้าถึงข้อมูลผู้อื่น', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc016', code: 'xx-xxx-xxx-xxx', name: 'การเรียนรู้ของเครื่อง (Machine Learning)', credits: 3, category: 'CoreComp', description: 'การเรียนรู้แบบมีผู้สอนและไม่มีผู้สอน การถดถอยและการจำแนกประเภท ต้นไม้ตัดสินใจ ซัพพอร์ตเวกเตอร์แมชชีน โครงข่ายประสาทเทียม การประเมินประสิทธิภาพโมเดล การปรับจูนพารามิเตอร์ การใช้ไลบรารีสำหรับการเรียนรู้ของเครื่อง \nSupervised and unsupervised learning; regression and classification; decision trees; support vector machines; neural networks; model performance evaluation; parameter tuning; using machine learning libraries', clos: ['อธิบายหลักการทำงานและความแตกต่างของอัลกอริทึมการเรียนรู้ของเครื่องแบบต่าง ๆ ได้', 'วิเคราะห์ปัญหาและเลือกใช้อัลกอริทึมที่เหมาะสมกับประเภทของข้อมูลและโจทย์ปัญหาได้', 'สร้างและฝึกโมเดลการเรียนรู้ของเครื่องโดยใช้ไลบรารีมาตรฐานได้', 'ประเมินประสิทธิภาพของโมเดลด้วยตัวชี้วัดที่เหมาะสม และปรับจูนพารามิเตอร์เพื่อเพิ่มประสิทธิภาพได้', 'ใช้เทคนิคการเรียนรู้ของเครื่องในการแก้ปัญหาจริงหรือโครงงานวิทยาการข้อมูลได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc017', code: '31-407-632-010', name: 'แนะนำปัญญาประดิษฐ์', credits: 3, category: 'CoreComp', description: 'การปฏิวัติอุตสาหกรรมยุคที่สี่ หลักการพื้นฐานของปัญญาประดิษฐ์ อุปสรรคและโอกาสของปัญญาประดิษฐ์ในงานอุตสาหกรรมอัจฉริยะ ประวัติศาสตร์และวิวัฒนาการของปัญญาประดิษฐ์ การเรียนรู้ของเครื่องขั้นพื้นฐาน การเรียนรู้เชิงลึกขั้นพื้นฐาน การเรียนรู้แบบเสริมกำลังขั้นพื้นฐาน การประยุกต์ใช้ปัญญาประดิษฐ์ในอุตสาหกรรมด้านต่าง ๆ กรณีศึกษาการใช้ปัญญาประดิษฐ์ในงานด้านวิศวกรรม \nThe fourth industrial revolution; basic artificial intelligence concepts; artificial intelligence challenges and opportunities within modern industries; history and evolution of artificial intelligence; introduction to machine learning; introduction to deep learning; introduction to reinforcement learning; applications of artificial intelligence in industry; case study of artificial intelligence in engineering', clos: ['อธิบายหลักการพื้นฐาน แนวคิด และประวัติศาสตร์ของปัญญาประดิษฐ์ รวมถึงความสัมพันธ์กับการปฏิวัติอุตสาหกรรมยุคที่สี่ได้อย่างถูกต้อง', 'อธิบายและเปรียบเทียบแนวทางของการเรียนรู้ของเครื่อง การเรียนรู้เชิงลึก และการเรียนรู้แบบเสริมกำลังได้อย่างเหมาะสม', 'วิเคราะห์อุปสรรคและโอกาสของการประยุกต์ใช้ปัญญาประดิษฐ์ในอุตสาหกรรมอัจฉริยะ ได้อย่างมีเหตุผล', 'อธิบายกรณีศึกษาการใช้ปัญญาประดิษฐ์ในงานด้านวิศวกรรมและอุตสาหกรรมต่าง ๆ ได้อย่างถูกต้อง', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'cc018', code: 'xx-xxx-xxx-xxx', name: 'จริยธรรมในการใช้ปัญญาประดิษฐ์', credits: 3, category: 'CoreComp', description: 'ยังไม่มีคำอธิยายรายวิชา', clos: ['ยังไม่มี CLOs'] },
            { id: 'cc019', code: '31-405-014-301', name: 'สัมมนา (Seminar)', credits: 1, category: 'CoreComp', description: 'การเลือกบทความวิจัยที่ทันสมัยทางคณิตศาสตร์ การนำเสนอบทความวิจัย อภิปรายและตอบคำถาม \nThe selection of recent research articles in mathematics, research presentation, discussion, questions and answers', clos: ['อธิบายหลักการและทฤษฎีพื้นฐานเกี่ยวกับคณิตศาสตร์ได้', 'เลือกใช้วิธีการและเครื่องมือในการนำเสนอข้อมูลงานตามลำดับขั้นตอนด้วยภาษาที่ถูกต้องตรงความหมาย', 'เชื่อมโยงความรู้สู่การวิเคราะห์ข้อมูลด้วยหลักการคณิตศาสตร์กับงานวิจัยได้', 'สืบค้น ค้นคว้าข้อมูลและอ้างอิงข้อมูลได้ถูกต้องตามหลักวิชาการโดยใช้เทคโนโลยีสารสนเทศ', 'รับผิดชอบทำงานที่ได้รับมอบหมายเสร็จตรงเวลา และปฏิบัติงานร่วมกับผู้อื่นได้', 'ให้ความช่วยเหลือและรับฟังความคิดเห็นต่อบุคคลและทีม และยอมรับความแตกต่างในสังคม'] },
            { id: 'cc020', code: '31-405-014-302', name: 'การเตรียมโครงงาน (Pre-Project)', credits: 1, category: 'CoreComp', description: 'ระเบียบวิธีวิจัย เทคโนโลยีสารสนเทศและปัญญาประดิษฐ์สำหรับโครงงานวิจัย การเขียนโครงงาน การนําเสนอโครงงาน \nResearch methodology; information technology and artificial intelligence for research project; proposal writing; proposal presentation', clos: ['อธิบายความรู้พื้นฐาน หลักการ และทฤษฎีทางด้านคณิตศาสตร์ที่เกี่ยวข้องกับหัวข้อวิจัยได้', 'ปฏิบัติตามจรรยาบรรณทางวิชาการและวิชาชีพ', 'นำความรู้ทางวิทยาศาสตร์และคณิตศาสตร์ไปประยุกต์กับสถานการณ์ต่างๆ ได้ถูกต้องและเหมาะสม', 'ผู้รับผิดชอบทำงานที่ได้รับมอบหมายเสร็จตรงเวลาและปฏิบัติงานร่วมกับผู้อื่นได้', 'เลือกใช้ภาษาและรูปแบบการสื่อสารได้เหมาะสม และนำเสนอหัวข้อวิจัยทางคณิตศาสตร์', 'เลือกใช้เทคโนโลยีสารสนเทศและปัญญาประดิษฐ์สืบค้นงานวิจัยทางคณิตศาสตร์'] },
            { id: 'cc021', code: '31-405-014-402', name: 'โครงงาน (Project)', credits: 2, category: 'CoreComp', description: 'การดำเนินงานโครงงาน การเก็บรวบรวมและวิเคราะห์ข้อมูล การสรุปจัดทำรายงาน การนำเสนอผลงานโครงงาน \nProject implementation, data collection and analysis, report writing, project presentation', clos: ['ใช้ความรู้พื้นฐาน หลักการ และทฤษฎีทางคณิตศาสตร์สำหรับการอธิบายหัวข้อวิจัยในศาสตร์ทางคณิตศาสตร์และศาสตร์อื่นที่เกี่ยวข้องได้', 'วางแผน และปฏิบัติงานตามกระบวนการทางวิทยาศาสตร์และเลือกใช้ทฤษฎีทางคณิตศาสตร์ได้ถูกต้อง', 'ทำงานร่วมกับผู้อื่นในบทบาทผู้นำและสมาชิกที่ดี สามารถปรับตัวเข้ากับสถานการณ์ต่าง ๆ ได้', 'ทำงานที่ได้รับมอบหมายให้เสร็จตรงเวลา มีความซื่อสัตย์ มีระเบียบวินัย', 'ปฏิบัติตามจรรยาบรรณทางวิชาการและเทคโนโลยี', 'ใช้เทคโนโลยีสารสนเทศสืบค้น ค้นคว้าข้อมูลและนำเสนองานได้'] },
            { id: 'ce001', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีจำนวนเบื้องต้น', credits: 3, category: 'CoreElec', description: 'การหารลงตัว สมภาค ฟังก์ชันในทฤษฎีจำนวน สามจำนวนของพีทาโกรัสและทฤษฎีบทสุดท้ายของแฟร์มา เศษส่วนต่อเนื่องและการประยุกต์ วิทยาการรหัสลับขั้นแนะนำ \nDivisibility; congruences; functions in number theory; Pythagorean triples and Fermat’s last theorem; continued fractions and applications; introduction to cryptography', clos: ['พิสูจน์สมบัติพื้นฐานเกี่ยวกับการหารลงตัว จำนวนเฉพาะ และสมภาคได้', 'คำนวณหาคำตอบของสมภาคและระบบสมภาคเชิงเส้นโดยใช้ทฤษฎีบทเศษเหลือของจีนได้', 'หาผลเฉลยของสมการไดโอแฟนไทน์เชิงเส้นและไม่ใช่เชิงเส้นรูปแบบง่ายได้', 'วิเคราะห์และประยุกต์ใช้ทฤษฎีจำนวนเพื่ออธิบายหลักการทำงานของวิทยาการรหัสลับเบื้องต้นได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'ce002', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีของสมการ (Theory of Equations)', credits: 3, category: 'CoreElec', description: 'พหุนาม รากของสมการพหุนาม ขอบเขตของราก ความสัมพันธ์ระหว่างรากกับสัมประสิทธิ์ สมการกำลังสาม สมการกำลังสี่ การแยกกันได้ของราก การประเมินค่าประมาณของราก ฟังก์ชันสมมาตร \nPolynomials; roots of polynomial equations; bounds of roots;  relation between the roots and the coefficients; cubic equations; biquadratic equations; separation of roots; evaluation of approximated roots; symmetric functions', clos: ['อธิบายทฤษฎีบทเกี่ยวกับรากของพหุนามและความสัมพันธ์กับสัมประสิทธิ์ได้อย่างถูกต้อง', 'หาผลเฉลยของสมการพหุนามและระบบสมการรูปแบบต่าง ๆ โดยใช้วิธีตรงและวิธีประมาณค่าได้', 'วิเคราะห์ชนิดและจำนวนรากของสมการโดยใช้กฎเครื่องหมายของเดส์การ์ตส์หรือทฤษฎีบทอื่น ๆ ได้', 'ใช้ความรู้เรื่องทฤษฎีสมการในการแก้ปัญหาทางคณิตศาสตร์ประยุกต์', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'ce003', code: 'xx-xxx-xxx-xxx', name: 'การวิเคราะห์เชิงตัวเลข (Numerical Analysis)', credits: 3, category: 'CoreElec', description: 'ยังไม่มีคำอธิบายรายวิชา', clos: ['ยังไม่มี CLOs'] },
            { id: 'ce004', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีกราฟเชิงขั้นตอนวิธี (Algorithmic Graph Theory)', credits: 3, category: 'CoreElec', description: 'แนวคิดพื้นฐานของกราฟและไดกราฟ กราฟต้นไม้และการประยุกต์ ขั้นตอนวิธีการค้น การให้สีกราฟข่ายงานและการไหล ปัญหาระยะทาง \nBasic concepts of graphs and digraphs; trees and applications; search algorithms; graph coloring; networks and flows; distance problems', clos: ['อธิบายนิยาม ทฤษฎีบท และสมบัติพื้นฐานของกราฟ กราฟต้นไม้ และกราฟชนิดพิเศษต่าง ๆ ได้อย่างถูกต้อง', 'วิเคราะห์โครงสร้างของกราฟเพื่อตรวจสอบคุณสมบัติความเชื่อมโยง ความเป็นระนาบ และการระบายสีได้', 'ประยุกต์ใช้ขั้นตอนวิธีบนกราฟในการค้นหาเส้นทางหรือแก้ปัญหาเชิงคำนวณพื้นฐานได้', 'สร้างแบบจำลองเพื่อแก้ปัญหาการวางแผนเครือข่าย หรือการจัดตารางเวลา ให้เป็นปัญหากราฟและหาคำตอบได้', 'มีวินัย ตรงต่อเวลาและเคารพกฎระเบียบข้อบังคับต่าง ๆ', 'มีความรับผิดชอบในการทำงานตามที่ได้รับมอบหมาย'] },
            { id: 'ce005', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีกรุป (Group Theory)', credits: 3, category: 'CoreElec', description: 'ทบทวนเรื่องกรุป อาบีเลียนกรุปอิสระ อาบีเลียนกรุปที่ก่อกำเนิดจากเซตจำกัด กรุปแอกชัน ทฤษฎีบทซีโล กรุปนิรพลและกรุปโซลเอเบิล \nReview of groups; free abelian groups; finitely generated abelian groups; group actions; the Sylow theorems; nilpotent and solvable groups', clos: ['ยังไม่มี CLOs'] },
            { id: 'ce006', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีริง (Ring Theory)', credits: 3, category: 'CoreElec', description: 'ผลบวกตรงของริง ริงแบบบูลีน ริงแบบปรกติ ริงของเมทริกซ์ \nDirect sums of rings; Boolean rings; regular rings; rings of matrices', clos: ['ยังไม่มี CLOs'] },
            { id: 'ce007', code: 'xx-xxx-xxx-xxx', name: 'โทโพโลยีขั้นแนะนำ (Introduction to Topology)', credits: 3, category: 'CoreElec', description: 'ปริภูมิอิงระยะทาง แนวคิดพื้นฐานสำหรับทอพอโลยี ทอพอโลยีสำหรับเส้นจำนวนจริง ปริภูมิเชิง   ทอพอโลยี ฟังก์ชันต่อเนื่อง ฐานและฐานย่อย ทอพอโลยีสำหรับเซตย่อย ความกระชับ ความเชื่อมโยง \nMetric spaces; basic concepts for topology; topology of real line; topological spaces; continuous functions; bases and subbases; topology for a subset; compactness; connectedness', clos: ['ยังไม่มี CLOs'] },
            { id: 'ce008', code: 'xx-xxx-xxx-xxx', name: 'ตัวแปรเชิงซ้อน (Complex Variables)', credits: 3, category: 'CoreElec', description: 'ระบบจำนวนเชิงซ้อน ฟังก์ชันมูลฐาน การหาอนุพันธ์ การหาปริพันธ์ อนุกรมลอเรนต์ ทฤษฎีบทส่วนตกค้างและการประยุกต์ การส่งคงแบบ \nComplex number system; elementary functions; differentiation; integration; Laurent  series; residues theorem and applications; conformal mapping', clos: ['ยังไม่มี CLOs'] },
            { id: 'ce009', code: 'xx-xxx-xxx-xxx', name: 'การวิเคราะห์ข้อมูลสำหรับอุตสาหกรรมและอินเทอร์เนตทุกสรรพสิ่ง (Industrial Data Analytics and IoT)', credits: 3, category: 'CoreElec', description: 'โครงสร้างและลักษณะข้อมูลจากอุปกรณ์ไอโอทีและระบบอุตสาหกรรม การจัดการข้อมูลขนาดใหญ่และข้อมูลแบบสตรีมมิง การวิเคราะห์อนุกรมเวลาจากเซนเซอร์ เทคนิคการตรวจจับความผิดปกติ การพยากรณ์เพื่อการบำรุงรักษาเชิงคาดการณ์ การใช้ภาษาโปรแกรมและเครื่องมือจัดการฐานข้อมูลสำหรับการวิเคราะห์ข้อมูลจริงในบริบทอุตสาหกรรมอัจฉริยะ \nStructure and characteristics of data from IoT devices and industrial systems; big data and streaming data management; time series analysis from sensors; anomaly detection techniques; forecasting for predictive maintenance; using programming languages and database management tools for analyzing real-world data in the context of smart industry', clos: ['อธิบายกระบวนการรวบรวมและจัดการข้อมูลจากอุปกรณ์ IoT ในระบบอุตสาหกรรมได้', 'ประยุกต์ใช้เทคนิคการวิเคราะห์ข้อมูลอนุกรมเวลาเพื่อตรวจจับความผิดปกติของเครื่องจักรได้', 'สร้างแบบจำลองพยากรณ์เพื่อสนับสนุนการบำรุงรักษาเชิงคาดการณ์ได้', 'ใช้โปรแกรมสำเร็จรูปร่วมกับฐานข้อมูลในการวิเคราะห์ข้อมูลอุตสาหกรรมขนาดใหญ่ได้'] },
            { id: 'ce010', code: 'xx-xxx-xxx-xxx', name: 'สถิติคณิตศาสตร์ (Mathematical Statistics)', credits: 3, category: 'CoreElec', description: 'ทฤษฎีความน่าจะเป็นและตัวแปรสุ่ม ฟังก์ชันการแจกแจงร่วมและการแปลงตัวแปร ทฤษฎีการแจกแจงของตัวสถิติ ทฤษฎีการประมาณค่าแบบจุดและแบบช่วง คุณสมบัติของตัวประมาณค่าและขีดจำกัดคราเมอร์-ราโอ ทฤษฎีการทดสอบสมมติฐาน เลมมาของเนย์แมน-เพียร์สัน และการทดสอบอัตราส่วนภาวะน่าจะเป็น ทฤษฎีบทลิมิตและการลู่เข้าของตัวแปรสุ่ม \nProbability theory and random variables; joint distribution functions and variable transformations; distribution theory of statistics; point and interval estimation theory; properties of estimators and Cramér–Rao bound; hypothesis testing theory; Neyman–Pearson lemma and Likelihood Ratio Test; limit theorems and convergence of random variables', clos: ['พิสูจน์ทฤษฎีบทพื้นฐานเกี่ยวกับความน่าจะเป็นและการแจกแจงของตัวแปรสุ่มได้', 'วิเคราะห์คุณสมบัติของตัวประมาณค่าและเปรียบเทียบประสิทธิภาพของตัวประมาณค่าได้', 'สร้างและทดสอบสมมติฐานทางสถิติโดยใช้หลักการทางคณิตศาสตร์ที่ถูกต้องได้', 'อธิบายและประยุกต์ใช้ทฤษฎีบทลิมิตในการอนุมานเชิงสถิติขั้นสูงได้'] },
            { id: 'ce011', code: 'xx-xxx-xxx-xxx', name: 'การวิเคราะห์พหุตัวแปร (Multivariate Analysis)', credits: 3, category: 'CoreElec', description: 'หลักการวิเคราะห์ข้อมูลที่มีตัวแปรจำนวนมาก การวิเคราะห์องค์ประกอบหลัก การวิเคราะห์ปัจจัย การวิเคราะห์การจัดกลุ่ม การวิเคราะห์การจำแนกกลุ่ม การใช้โปรแกรมสำเร็จรูปทางสถิติหรือภาษาโปรแกรมสำหรับการประมวลผลและวิเคราะห์ข้อมูลพหุตัวแปร การแปลผลและการนำไปประยุกต์ใช้กับข้อมูลจริง \nPrinciples of multivariate data analysis; Principal Component Analysis; Factor Analysis; Cluster Analysis; Discriminant Analysis; using statistical software packages or programming languages for multivariate data processing and analysis; interpretation and application to real-world data', clos: ['อธิบายหลักการและข้อสมมติของการวิเคราะห์สถิติพหุตัวแปรแต่ละวิธีได้', 'เลือกใช้วิธีการวิเคราะห์พหุตัวแปรที่เหมาะสมกับลักษณะข้อมูลและวัตถุประสงค์การวิจัยได้', 'ปฏิบัติการใช้โปรแกรมสำเร็จรูปหรือเขียนโปรแกรมเพื่อวิเคราะห์ข้อมูลพหุตัวแปรได้', 'วิเคราะห์และแปลความหมายผลลัพธ์จากการวิเคราะห์องค์ประกอบหลัก ปัจจัย การจัดกลุ่ม และการจำแนกกลุ่มได้อย่างถูกต้อง'] },
            { id: 'ce012', code: 'xx-xxx-xxx-xxx', name: 'ทฤษฎีค่าขีดสุด (Extreme Value Theory)', credits: 3, category: 'CoreElec', description: 'ทฤษฎีและแบบจำลองทางสถิติสำหรับเหตุการณ์สุดขีด การแจกแจงค่าสุดขีดทั่วไป การแจกแจงพาเรโตทั่วไป การเลือกเกณฑ์แบ่งกั้นและขนาดบล็อก การประมาณค่าพารามิเตอร์ด้วยวิธีภาวะน่าจะเป็นสูงสุดและวิธีแบบเบย์ การประยุกต์ใช้สถิติแบบเบย์และการประมาณค่าด้วยวิธีมาร์คอฟเชนจ์มอนติคาร์โล การใช้โปรแกรมคอมพิวเตอร์สำหรับการวิเคราะห์ข้อมูลที่มีความไม่แน่นอนสูง \nTheory and statistical models for extreme events; Generalized Extreme Value distribution (GEV); Generalized Pareto Distribution (GPD); threshold selection and block size; parameter estimation using Maximum Likelihood and Bayesian methods; application of Bayesian statistics and Markov Chain Monte Carlo estimation; using computer software for analyzing high-uncertainty data', clos: ['อธิบายแนวคิดทฤษฎีค่าสุดขั้วและแบบจำลองทางสถิติที่เกี่ยวข้องได้', 'เลือกและประยุกต์ใช้แบบจำลอง GEV หรือ GPD กับข้อมูลค่าสุดขั้วได้อย่างเหมาะสม', 'ประมาณค่าพารามิเตอร์ของแบบจำลองด้วยวิธีภาวะน่าจะเป็นสูงสุดและวิธีแบบเบย์ได้', 'ใช้โปรแกรมสำเร็จรูปในการวิเคราะห์และพยากรณ์ความเสี่ยงจากเหตุการณ์สุดขีดได้'] },
            { id: 'cx001', code: '31-405-015-401', name: 'การเตรียมความพร้อมการฝึกประสบการณ์วิชาชีพ (Preparation for Professional Experience)', credits: 1, category: 'CoreExp', description: 'หลักการและแนวคิดของการฝึกประสบการณ์วิชาชีพ การสมัครงานและการสัมภาษณ์งาน การพัฒนาบุคลิกภาพในการทำงาน การปรับตัวในองค์กร การทำงานเป็นทีม จรรยาบรรณวิชาชีพ กฎหมายแรงงาน การประกันสังคม ระบบมาตรฐานการประกันคุณภาพและความปลอดภัยในการทำงาน การสื่อสารในองค์กร การเลือกหัวข้อปัญหา การวางแผน การวิเคราะห์และการแก้ปัญหา การเขียนรายงานและการนำเสนอ \nTypes and processes of professional experience; job application and job interview; personality development, work adjustment; teamwork; professional ethics; labour law; social security; quality assurance standard system and occupational safety, communication in the workplace, choosing a topic; planning; analysis and problem-solving; writing a report and a presentation', clos: ['อธิบายหลักการและแนวคิดของการฝึกประสบการณ์วิชาชีพ', 'อธิบายขั้นตอนการสมัครงาน การสัมภาษณ์งาน การพัฒนาบุคลิกภาพในการทำงาน', 'อธิบายหลักการในการทำงานเป็นทีมได้ ปรับตัวในองค์กร สื่อสารในองค์กรได้', 'อธิบายจรรยาบรรณวิชาชีพ กฎหมายแรงงาน การประกันสังคม ระบบมาตรฐานการประกันคุณภาพและความปลอดภัยในการทำงาน', 'อธิบายหลักการเลือกหัวข้อปัญหา วางแผนการวิเคราะห์และการแก้ปัญหารวมถึงการเขียนรายงานและการนำเสนอ'] },
            { id: 'cx002', code: '31-405-015-402', name: 'สหกิจศึกษา 1 (Cooperative Education 1)', credits: 6, category: 'CoreExp', description: 'การปฏิบัติงานเสมือนเป็นพนักงานในสถานประกอบการที่ตรงกับสาขา วิชาชีพและเหมาะสมกับความรู้ความสามารถ กระบวนการทำงานและหน้าที่ ของตำแหน่งงานที่ได้รับมอบหมาย และการประยุกต์ใช้ความรู้ทางทฤษฎีที่ เกี่ยวข้อง การจัดทำโครงงาน จากกรณีศึกษาหรือการเรียนรู้โดยใช้การ แก้ปัญหาเป็นฐาน จรรยาบรรณทางวิชาชีพในการปฏิบัติงาน \nPracticing in a workplace as an employee in a relevant position of the student’s field of study and abilities; understanding working processes and functions of the assigned job; applying the principle of knowledge and theory relevant to the duties or assigned job; preparing a project report by using the problem or case-based learning method; professional ethics', clos: ['ปฏิบัติงานในสถานประกอบการที่ตรงกับความรู้ในสาขาวิชาชีพของตนเอง', 'ปฏิบัติงานจริงตามกระบวนการและหน้าที่ของตำแหน่งที่ได้รับมอบหมาย และเหมาะสมกับความรู้ความสามารถ', 'วิเคราะห์ปัญหาและจัดทำโครงงานจากกรณีศึกษาหรือการเรียนรู้โดยใช้ การแก้ปัญหาเป็นฐาน', 'ปฏิบัติงานตรงเวลามีความรับผิดชอบมีความสัมพันธ์ที่ดีระหว่าง บุคคล ทำงานเป็นทีมได้ และปฏิบัติตนตามจรรยาบรรณทางวิชาชีพ'] },
            { id: 'fe001', code: 'xx-xxx-xxx-xxx', name: 'วิชาเลือกเสรี 1', credits: 3, category: 'FreeElec', description: '', clos: [] },
            { id: 'fe002', code: 'xx-xxx-xxx-xxx', name: 'วิชาเลือกเสรี 2', credits: 3, category: 'FreeElec', description: '', clos: [] }
        ];

        const YEARS = 4;
        const SEMESTERS = 2;

        const getInitialPlan = () => {
            const plan = {};
            for (let y = 1; y <= YEARS; y++) {
                for (let s = 1; s <= SEMESTERS; s++) {
                    plan[`${y}-${s}`] = [];
                }
            }
            return plan;
        };

        const App = () => {
            const [plan, setPlan] = useState(getInitialPlan);
            const [availableCourses, setAvailableCourses] = useState(INITIAL_COURSES);
            const [draggedItem, setDraggedItem] = useState(null);
            const [isExporting, setIsExporting] = useState(false);
            
            // Modal & Editing State
            const [viewingCourse, setViewingCourse] = useState(null);
            const [isEditing, setIsEditing] = useState(false);
            const [editData, setEditData] = useState({ description: '', closText: '' });

            const categoryTotals = useMemo(() => {
                const totals = { 'GenEd': 0, 'CoreFund': 0, 'CoreComp': 0, 'CoreElec': 0, 'CoreExp': 0, 'FreeElec': 0 };
                Object.values(plan).flat().forEach(course => {
                    if (totals[course.category] !== undefined) totals[course.category] += course.credits;
                });
                return totals;
            }, [plan]);

            // Initialize Edit Data when opening Modal
            useEffect(() => {
                if (viewingCourse) {
                    setEditData({
                        description: viewingCourse.description || '',
                        closText: (viewingCourse.clos || []).join('\n')
                    });
                    setIsEditing(false);
                }
            }, [viewingCourse]);

            // --- Handlers for Course Update & Save ---
            const handleSaveCourse = () => {
                const updatedDescription = editData.description;
                const updatedCLOs = editData.closText.split('\n').filter(line => line.trim() !== '');

                // 1. Update in Memory (availableCourses or Plan)
                const updateCourseInList = (list) => list.map(c => 
                    c.id === viewingCourse.id 
                    ? { ...c, description: updatedDescription, clos: updatedCLOs } 
                    : c
                );

                setAvailableCourses(prev => updateCourseInList(prev));
                setPlan(prev => {
                    const newPlan = { ...prev };
                    Object.keys(newPlan).forEach(key => {
                        newPlan[key] = updateCourseInList(newPlan[key]);
                    });
                    return newPlan;
                });

                // Update current viewing object to reflect changes
                setViewingCourse(prev => ({ ...prev, description: updatedDescription, clos: updatedCLOs }));
                setIsEditing(false);

                // 2. Generate Text File for Developer
                const closFormatted = updatedCLOs.map(c => `'${c}'`).join(',\n        ');
                // Escape single quotes in description for JS safety if needed, but simple for now
                const fileContent = `
/* ข้อมูลสำหรับนำไปแทนที่ในโค้ด (Copy & Paste) */

// วิชา: ${viewingCourse.code} ${viewingCourse.name}
{
    ...
    description: '${updatedDescription.replace(/\n/g, '\\n')}',
    clos: [
        ${closFormatted}
    ]
},
                `;
                downloadTextFile(`course_update_${viewingCourse.code}.txt`, fileContent.trim());
            };

            // --- Existing Drag & Drop Logic ---
            const handleDragStart = (e, course, source, index) => {
                const item = { course, source, index };
                setDraggedItem(item);
                e.dataTransfer.effectAllowed = "move";
                e.dataTransfer.setData("application/json", JSON.stringify(item));
            };
            const handleDropToSemesterContainer = (e, year, semester) => {
                e.preventDefault(); e.currentTarget.classList.remove('drag-over');
                let item = draggedItem;
                if (!item) { try { item = JSON.parse(e.dataTransfer.getData("application/json")); } catch (err) {} }
                if (!item) return;
                const { course, source, index: sourceIndex } = item;
                const targetKey = `${year}-${semester}`;
                if (source === targetKey) {
                    setPlan(prev => {
                        const list = [...prev[targetKey]];
                        list.splice(sourceIndex, 1); list.push(course);
                        return { ...prev, [targetKey]: list };
                    });
                } else {
                    if (source === 'sidebar') setAvailableCourses(prev => prev.filter(c => c.id !== course.id));
                    else setPlan(prev => ({ ...prev, [source]: (prev[source] || []).filter(c => c.id !== course.id) }));
                    setPlan(prev => ({ ...prev, [targetKey]: [...(prev[targetKey] || []), course] }));
                }
                setDraggedItem(null);
            };
            const handleDropToItem = (e, targetYear, targetSemester, targetIndex) => {
                e.preventDefault(); e.stopPropagation(); e.currentTarget.classList.remove('drag-over-item');
                let item = draggedItem;
                if (!item) { try { item = JSON.parse(e.dataTransfer.getData("application/json")); } catch (err) {} }
                if (!item) return;
                const { course, source, index: sourceIndex } = item;
                const targetKey = `${targetYear}-${targetSemester}`;
                if (source === targetKey) {
                    if (sourceIndex === targetIndex) return;
                    setPlan(prev => {
                        const list = [...prev[targetKey]];
                        const [removed] = list.splice(sourceIndex, 1);
                        const insertAt = (targetIndex > sourceIndex) ? targetIndex - 1 : targetIndex;
                        list.splice(insertAt, 0, removed);
                        return { ...prev, [targetKey]: list };
                    });
                } else {
                    if (source === 'sidebar') setAvailableCourses(prev => prev.filter(c => c.id !== course.id));
                    else setPlan(prev => ({ ...prev, [source]: (prev[source] || []).filter(c => c.id !== course.id) }));
                    setPlan(prev => {
                        const list = [...(prev[targetKey] || [])];
                        list.splice(targetIndex, 0, course);
                        return { ...prev, [targetKey]: list };
                    });
                }
                setDraggedItem(null);
            };
            const handleDropToSidebar = (e) => {
                e.preventDefault(); e.currentTarget.classList.remove('drag-over'); 
                let item = draggedItem;
                if (!item) { try { item = JSON.parse(e.dataTransfer.getData("application/json")); } catch (err) {} }
                if (!item) return;
                const { course, source } = item;
                if (source === 'sidebar') return; 
                setPlan(prev => ({ ...prev, [source]: (prev[source] || []).filter(c => c.id !== course.id) }));
                setAvailableCourses(prev => [...prev, course]);
                setDraggedItem(null);
            };
            const handleDragOver = (e) => { e.preventDefault(); e.currentTarget.classList.add('drag-over'); };
            const handleDragOverItem = (e) => { e.preventDefault(); e.stopPropagation(); e.currentTarget.classList.add('drag-over-item'); };
            const handleDragLeave = (e) => { e.currentTarget.classList.remove('drag-over'); };
            const handleDragLeaveItem = (e) => { e.currentTarget.classList.remove('drag-over-item'); };
            const removeCourse = (course, sourceKey) => {
                setPlan(prev => ({ ...prev, [sourceKey]: (prev[sourceKey] || []).filter(c => c.id !== course.id) }));
                setAvailableCourses(prev => [...prev, course]);
            };

            const calculateTotalCredits = (courses) => courses.reduce((sum, c) => sum + c.credits, 0);
            const calculateTotalAll = useMemo(() => Object.values(plan).flat().reduce((sum, c) => sum + c.credits, 0), [plan]);

            // --- Export UI ---
            const exportToPNG = async () => {
                const element = document.getElementById('planner-grid-area'); if (!element) return;
                setIsExporting(true);
                try {
                    const canvas = await html2canvas(element, { backgroundColor: '#ffffff', scale: 3, useCORS: true });
                    const link = document.createElement('a'); link.download = 'study-plan.png'; link.href = canvas.toDataURL(); link.click();
                } catch (err) { alert("Error saving PNG"); } finally { setIsExporting(false); }
            };
            const exportToPDF = async () => {
                const element = document.getElementById('planner-grid-area'); if (!element) return;
                setIsExporting(true);
                try {
                    const canvas = await html2canvas(element, { backgroundColor: '#ffffff', scale: 3, useCORS: true });
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jspdf.jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
                    const pageWidth = pdf.internal.pageSize.getWidth(); const pageHeight = pdf.internal.pageSize.getHeight();
                    const margin = 10; const maxWidth = pageWidth - (margin * 2); const maxHeight = pageHeight - (margin * 2);
                    const imgProps = pdf.getImageProperties(imgData); const imgRatio = imgProps.width / imgProps.height; const pageRatio = maxWidth / maxHeight;
                    let finalWidth, finalHeight;
                    if (imgRatio > pageRatio) { finalWidth = maxWidth; finalHeight = maxWidth / imgRatio; } 
                    else { finalHeight = maxHeight; finalWidth = maxHeight * imgRatio; }
                    const x = (pageWidth - finalWidth) / 2; const y = (pageHeight - finalHeight) / 2;
                    pdf.addImage(imgData, 'PNG', x, y, finalWidth, finalHeight); pdf.save('study-plan.pdf');
                } catch (err) { alert("Error saving PDF"); } finally { setIsExporting(false); }
            };

            // --- Helpers for Display ---
            const parseDescription = (desc) => {
                if (!desc) return { th: 'ยังไม่มีข้อมูลคำอธิบายรายวิชา', en: '' };
                const parts = desc.split('\n');
                if (parts.length > 1) return { th: parts[0], en: parts.slice(1).join('\n') };
                return { th: desc, en: '' };
            };
            const getCLOs = (course) => (course.clos && course.clos.length > 0) ? course.clos : ['ยังไม่มีข้อมูล CLO'];

            return (
                <div className="min-h-screen flex flex-col md:flex-row">
                    
                    {/* --- Modal with Edit Mode --- */}
                    {viewingCourse && (
                        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 modal-overlay" onClick={() => { if(!isEditing) setViewingCourse(null); }}>
                            <div className="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col modal-content" onClick={e => e.stopPropagation()}>
                                {/* Header */}
                                <div className={`p-6 border-b-4 flex-shrink-0 flex justify-between items-start ${CATEGORIES[viewingCourse.category].border.replace('border', 'border-b')}`}>
                                    <div>
                                        <span className={`inline-block px-2 py-1 rounded text-xs font-bold mb-2 ${CATEGORIES[viewingCourse.category].color}`}>
                                            {CATEGORIES[viewingCourse.category].label}
                                        </span>
                                        <div className="flex items-center gap-3">
                                            <h3 className="text-2xl font-bold text-gray-900">{viewingCourse.code}</h3>
                                            <span className="text-sm font-semibold text-gray-500 bg-gray-100 px-2 py-1 rounded-md">{viewingCourse.credits} หน่วยกิต</span>
                                        </div>
                                        <h4 className="text-xl font-medium text-gray-700 mt-1">{viewingCourse.name}</h4>
                                    </div>
                                    <div className="flex gap-2">
                                        {!isEditing && (
                                            <button onClick={() => setIsEditing(true)} className="flex items-center gap-1 px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition-colors font-semibold">
                                                <i className="ph ph-pencil-simple"></i> แก้ไข
                                            </button>
                                        )}
                                        <button onClick={() => setViewingCourse(null)} className="text-gray-400 hover:text-gray-600 bg-gray-100 rounded-full p-2 transition-colors">
                                            <i className="ph ph-x text-xl"></i>
                                        </button>
                                    </div>
                                </div>

                                {/* Body */}
                                <div className="p-0 overflow-y-auto flex-1 bg-gray-50">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-0 h-full">
                                        {/* Left Column: Description */}
                                        <div className="p-6 border-r border-gray-200 bg-white h-full">
                                            <h5 className="font-bold text-gray-800 mb-3 flex items-center gap-2 text-sm uppercase tracking-wide">
                                                <i className="ph ph-translate text-indigo-600"></i> 
                                                {isEditing ? 'แก้ไขคำอธิบายรายวิชา (Description)' : 'คำอธิบายรายวิชา (Description)'}
                                            </h5>
                                            {isEditing ? (
                                                <textarea 
                                                    className="w-full h-[300px] p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm font-sarabun"
                                                    value={editData.description}
                                                    onChange={(e) => setEditData({...editData, description: e.target.value})}
                                                    placeholder="ใส่คำอธิบายรายวิชา (ภาษาไทย ขึ้นบรรทัดใหม่ ภาษาอังกฤษ)"
                                                />
                                            ) : (
                                                <div className="space-y-4">
                                                    <p className="text-gray-700 text-sm leading-relaxed whitespace-pre-line text-justify">
                                                        {parseDescription(viewingCourse.description).th}
                                                    </p>
                                                    {parseDescription(viewingCourse.description).en && (
                                                        <div className="pt-4 border-t border-gray-100">
                                                            <p className="text-gray-600 text-sm leading-relaxed whitespace-pre-line text-justify italic">
                                                                {parseDescription(viewingCourse.description).en}
                                                            </p>
                                                        </div>
                                                    )}
                                                </div>
                                            )}
                                        </div>

                                        {/* Right Column: CLOs */}
                                        <div className="p-6 bg-gray-50 h-full">
                                            <h5 className="font-bold text-gray-800 mb-3 flex items-center gap-2 text-sm uppercase tracking-wide">
                                                <i className="ph ph-target text-indigo-600"></i> 
                                                {isEditing ? 'แก้ไขผลลัพธ์การเรียนรู้ (CLOs)' : 'ผลลัพธ์การเรียนรู้ (CLOs)'}
                                            </h5>
                                            {isEditing ? (
                                                <div>
                                                    <textarea 
                                                        className="w-full h-[300px] p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm font-sarabun"
                                                        value={editData.closText}
                                                        onChange={(e) => setEditData({...editData, closText: e.target.value})}
                                                        placeholder="ใส่ CLO บรรทัดละ 1 ข้อ"
                                                    />
                                                    <p className="text-xs text-gray-500 mt-2">* พิมพ์แยกบรรทัด 1 บรรทัด = 1 ข้อ</p>
                                                </div>
                                            ) : (
                                                <ul className="space-y-3">
                                                    {getCLOs(viewingCourse).map((clo, idx) => (
                                                        <li key={idx} className="flex items-start gap-2 text-sm text-gray-700 leading-normal">
                                                            <span className="font-bold text-indigo-600 min-w-[1.5rem]">{idx + 1}.</span>
                                                            <span>{clo}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            )}
                                        </div>
                                    </div>
                                </div>

                                {/* Footer Actions */}
                                <div className="p-4 bg-white border-t border-gray-100 flex justify-end gap-3 flex-shrink-0">
                                    {isEditing ? (
                                        <>
                                            <button 
                                                onClick={() => setIsEditing(false)}
                                                className="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium transition-colors"
                                            >
                                                ยกเลิก
                                            </button>
                                            <button 
                                                onClick={handleSaveCourse}
                                                className="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium transition-colors shadow-sm flex items-center gap-2"
                                            >
                                                <i className="ph ph-floppy-disk"></i> บันทึกและดาวน์โหลดไฟล์
                                            </button>
                                        </>
                                    ) : (
                                        <button 
                                            onClick={() => setViewingCourse(null)}
                                            className="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium transition-colors"
                                        >
                                            ปิดหน้าต่าง
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* --- Sidebar & Main Content (Same as previous, shortened for brevity but functional) --- */}
                    {/* Sidebar */}
                    <div className="w-full md:w-1/4 bg-white border-r border-gray-200 p-4 h-screen-md md:h-screen overflow-y-auto sticky top-0 droppable-area no-scrollbar"
                        onDragOver={handleDragOver} onDragLeave={handleDragLeave} onDrop={handleDropToSidebar} style={{height:'100vh', paddingBottom:'50px'}}>
                        <div className="flex items-center justify-between mb-6">
                            <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2"><i className="ph ph-books text-indigo-600"></i> รายวิชาคงเหลือ</h2>
                            <span className="text-xs bg-gray-100 px-2 py-1 rounded-full text-gray-500">{availableCourses.length} วิชา</span>
                        </div>
                        {availableCourses.length===0 && <div className="text-center p-8 text-gray-400 border-2 border-dashed border-gray-200 rounded-lg"><p>เลือกรายวิชาครบแล้ว</p></div>}
                        {Object.keys(CATEGORIES).map(catKey => {
                            const coursesInCat = availableCourses.filter(c => c.category === catKey);
                            if(coursesInCat.length===0) return null;
                            return (
                                <div key={catKey} className="mb-6">
                                    <h3 className="text-sm font-bold text-gray-700 mb-2 pb-1 border-b border-gray-100">{CATEGORIES[catKey].label}</h3>
                                    <div className="space-y-2">
                                        {coursesInCat.map((course, idx) => (
                                            <div key={course.id} draggable onDragStart={(e)=>handleDragStart(e,course,'sidebar',idx)} className={`card-drag p-3 rounded-lg border shadow-sm flex justify-between items-start bg-white hover:shadow-md select-none ${CATEGORIES[course.category].border}`}>
                                                <div><div className="flex items-center gap-2"><span className="font-bold text-sm text-gray-800">{course.code}</span><span className={`text-[10px] px-1.5 py-0.5 rounded ${CATEGORIES[course.category].color}`}>{course.credits} นก.</span></div><div className="text-xs text-gray-600 mt-1 line-clamp-1">{course.name}</div></div>
                                                <div className="flex flex-col items-center gap-2"><i className="ph ph-dots-six-vertical text-gray-300 cursor-move"></i><button onClick={(e)=>{e.stopPropagation();setViewingCourse(course);}} className="text-gray-300 hover:text-indigo-500 transition-colors"><i className="ph ph-info text-lg"></i></button></div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    {/* Main Content */}
                    <div className="flex-1 p-4 md:p-8 overflow-y-auto bg-gray-50">
                        <header className="mb-8 flex flex-col xl:flex-row justify-between items-start xl:items-center gap-4">
                            <div><h1 className="text-3xl font-bold text-gray-900">แผนการเรียน 4 ปี</h1><p className="text-gray-500 text-sm mt-1">ลากรายวิชาจากด้านซ้ายลงในภาคการศึกษาที่ต้องการ</p></div>
                            <div className="flex flex-wrap items-center gap-4">
                                <div className="flex gap-2">
                                    <button onClick={exportToPNG} disabled={isExporting} className="flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 text-sm font-medium transition-colors shadow-sm"><i className="ph ph-image text-lg"></i> PNG</button>
                                    <button onClick={exportToPDF} disabled={isExporting} className="flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 text-sm font-medium transition-colors shadow-sm"><i className="ph ph-file-pdf text-lg"></i> PDF</button>
                                </div>
                                <div className="bg-indigo-600 text-white px-6 py-2 rounded-xl shadow-lg flex flex-col items-center min-w-[120px]"><span className="text-[10px] opacity-80 uppercase tracking-wider">หน่วยกิตรวม</span><span className="text-2xl font-bold">{calculateTotalAll}</span></div>
                            </div>
                        </header>
                        <div id="planner-grid-area" className="p-6 bg-white rounded-2xl shadow-sm border border-gray-200">
                            <div className="flex justify-between items-end mb-6 pb-4 border-b border-gray-100">
                                <div><h2 className="text-2xl font-bold text-gray-800">แผนการเรียน 4 ปี</h2><p className="text-sm text-gray-500">Interactive Study Plan</p></div>
                                <div className="text-right"><span className="text-xs font-semibold text-gray-500 uppercase tracking-wider">หน่วยกิตรวมสะสม</span><div className="text-3xl font-bold text-indigo-600">{calculateTotalAll}</div></div>
                            </div>
                            <div className="mb-6 grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-3">
                                {Object.keys(CATEGORIES).map(catKey => {
                                    const config = CATEGORIES[catKey]; const total = categoryTotals[catKey] || 0;
                                    const borderColorClass = config.border; const bgClass = config.color.split(' ')[0].replace('100', '50'); const textClass = config.color.split(' ')[1];
                                    return (<div key={catKey} className={`p-3 rounded-lg border ${borderColorClass} ${bgClass} flex flex-col items-center justify-center text-center shadow-sm`}><span className={`text-[10px] font-bold uppercase tracking-wider opacity-70 mb-1 ${textClass}`}>{config.shortLabel}</span><span className={`text-xl font-bold ${textClass}`}>{total} <span className="text-[10px] font-normal opacity-70">นก.</span></span></div>);
                                })}
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
                                {[1, 2, 3, 4].map(year => (
                                    <div key={year} className="contents">
                                        {[1, 2].map(semester => {
                                            const key = `${year}-${semester}`; const courses = plan[key] || []; const totalCredits = calculateTotalCredits(courses); const isOverloaded = totalCredits > 22;
                                            return (
                                                <div key={key} className={`droppable-area bg-gray-50 rounded-xl border border-gray-200 shadow-sm flex flex-col h-full min-h-[300px] ${isOverloaded ? 'ring-2 ring-red-300' : ''}`}
                                                    onDragOver={handleDragOver} onDragLeave={handleDragLeave} onDrop={(e) => handleDropToSemesterContainer(e, year, semester)}>
                                                    <div className="p-3 border-b border-gray-200 flex justify-between items-center bg-white rounded-t-xl"><div><span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">Year {year}</span><h3 className="font-bold text-gray-800 text-sm">เทอม {semester}</h3></div><div className={`px-2 py-0.5 rounded text-[10px] font-bold ${isOverloaded ? 'bg-red-100 text-red-600' : 'bg-indigo-50 text-indigo-600'}`}>{totalCredits} นก.</div></div>
                                                    <div className="p-2 flex-1 space-y-2">
                                                        {courses.length === 0 ? <div className="h-full flex flex-col items-center justify-center text-gray-300 pointer-events-none min-h-[100px]"><i className="ph ph-plus-circle text-2xl mb-1"></i><span className="text-[10px]">วางวิชาที่นี่</span></div> : 
                                                            courses.map((course, index) => (
                                                                <div key={`${course.id}-${index}`} draggable onDragStart={(e) => handleDragStart(e, course, key, index)} onDrop={(e) => handleDropToItem(e, year, semester, index)} onDragOver={handleDragOverItem} onDragLeave={handleDragLeaveItem} className={`card-drag group relative p-2.5 rounded-lg border-l-4 shadow-sm bg-white hover:shadow hover:scale-[1.02] ${CATEGORIES[course.category] ? CATEGORIES[course.category].border.replace('border', 'border-l') : 'border-gray-200'}`}>
                                                                    <div className="flex justify-between items-start"><div className="w-full"><div className="font-bold text-xs text-gray-800">{course.code}</div><div className="text-[11px] text-gray-600 leading-tight my-1 pr-4">{course.name}</div></div><div className="flex flex-col gap-1 items-center absolute top-1 right-1"><button onClick={() => removeCourse(course, key)} className="opacity-0 group-hover:opacity-100 text-gray-300 hover:text-red-500 transition-opacity" title="นำออก"><i className="ph ph-x-circle text-lg"></i></button><button onClick={(e) => { e.stopPropagation(); setViewingCourse(course); }} className="text-gray-300 hover:text-indigo-500 transition-colors" title="ดูคำอธิบาย"><i className="ph ph-info text-lg"></i></button></div></div>
                                                                    <div className="flex justify-between items-center mt-1"><span className={`text-[9px] px-1.5 py-0.5 rounded ${CATEGORIES[course.category] ? CATEGORIES[course.category].color : 'bg-gray-100'}`}>{CATEGORIES[course.category] ? CATEGORIES[course.category].label.split(' ')[1] || CATEGORIES[course.category].label : 'Unknown'}</span><span className="text-[10px] font-semibold text-gray-400">{course.credits}</span></div>
                                                                </div>
                                                            ))
                                                        }
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>